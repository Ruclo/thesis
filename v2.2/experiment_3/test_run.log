/thesis/parallel/3-openshift-virtualization-tests/.venv/lib/python3.14/site-packages/kubernetes/client/exceptions.py:91: DeprecationWarning: HTTPResponse.getheaders() is deprecated and will be removed in urllib3 v2.1.0. Instead access HTTPResponse.headers directly.
  self.headers = http_resp.getheaders()
/thesis/parallel/3-openshift-virtualization-tests/.venv/lib/python3.14/site-packages/kubernetes/client/exceptions.py:91: DeprecationWarning: HTTPResponse.getheaders() is deprecated and will be removed in urllib3 v2.1.0. Instead access HTTPResponse.headers directly.
  self.headers = http_resp.getheaders()
2026-02-10T11:45:48.150744 ocp_resources Namespace INFO Create Namespace cnv-tests-run-in-progress-ns
2026-02-10T11:45:48.150985 ocp_resources Namespace INFO Posting {'apiVersion': 'v1', 'kind': 'Namespace', 'metadata': {'name': 'cnv-tests-run-in-progress-ns'}, 'spec': {}}
2026-02-10T11:45:48.168807 ocp_resources Namespace INFO Wait until Namespace cnv-tests-run-in-progress-ns is created
2026-02-10T11:45:48.182987 ocp_resources Namespace INFO Wait for Namespace cnv-tests-run-in-progress-ns status to be Active
2026-02-10T11:45:48.191933 ocp_resources Namespace INFO Status of Namespace cnv-tests-run-in-progress-ns is Active
2026-02-10T11:45:48.192949 ocp_resources Namespace INFO Update Namespace cnv-tests-run-in-progress-ns:
{'metadata': {'labels': {'pod-security.kubernetes.io/enforce': 'privileged', 'security.openshift.io/scc.podSecurityLabelSync': 'false'}, 'name': 'cnv-tests-run-in-progress-ns'}}
2026-02-10T11:45:48.207407 ocp_resources ConfigMap INFO Create ConfigMap cnv-tests-run-in-progress
2026-02-10T11:45:48.207792 ocp_resources ConfigMap INFO Posting {'apiVersion': 'v1', 'kind': 'ConfigMap', 'metadata': {'name': 'cnv-tests-run-in-progress', 'namespace': 'cnv-tests-run-in-progress-ns'}, 'data': '*******'}
2026-02-10T11:45:48.229315 ocp_resources ConfigMap INFO Wait until ConfigMap cnv-tests-run-in-progress is created
=================================================================================== test session starts ====================================================================================
platform linux -- Python 3.14.3, pytest-9.0.2, pluggy-1.6.0
benchmark: 5.2.3 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
rootdir: /thesis/parallel/3-openshift-virtualization-tests
configfile: pytest.ini (WARNING: ignoring pytest config in pyproject.toml!)
plugins: repeat-0.9.4, metadata-3.1.1, mock-3.15.1, anyio-4.12.1, benchmark-5.2.3, dependency-0.6.0, html-4.1.1, jira-0.3.22, order-1.3.0, progress-1.4.0, testconfig-0.2.0
collected 12 items                                                                                                                                                                         

tests/virt/node/general/test_vmi_reset_comprehensive.py 2026-02-10T11:49:46.395772 tests.virt.node.general.test_vmi_reset_comprehensive INFO Boot count after reset: 3
.
______________________________________________________ 1 of 12 completed, 1 Pass, 0 Fail, 0 Skip, 0 XPass, 0 XFail, 0 Error, 0 ReRun _______________________________________________________

tests/virt/node/general/test_vmi_reset_comprehensive.py 2026-02-10T11:50:28.831517 tests.virt.node.general.test_vmi_reset_comprehensive INFO Boot count after reset: 4
.
______________________________________________________ 2 of 12 completed, 2 Pass, 0 Fail, 0 Skip, 0 XPass, 0 XFail, 0 Error, 0 ReRun _______________________________________________________

tests/virt/node/general/test_vmi_reset_comprehensive.py 
TEST: TestVMIReset.test_reset_running_vmi_via_virtctl STATUS: PASSED
------------------------------------------------------- TEARDOWN -------------------------------------------------------
2026-02-10T11:51:11.020478 tests.virt.node.general.test_vmi_reset_comprehensive INFO VMI UID after reset: 66eee215-2dfa-4a5e-bbf6-b45427c8a62b
.
TEST: TestVMIReset.test_vmi_uid_unchanged_after_reset STATUS: PASSED
------------------------------------------------------- TEARDOWN -------------------------------------------------------

______________________________________________________ 3 of 12 completed, 3 Pass, 0 Fail, 0 Skip, 0 XPass, 0 XFail, 0 Error, 0 ReRun _______________________________________________________

tests/virt/node/general/test_vmi_reset_comprehensive.py 
------------------------------------------ test_vmi_pod_unchanged_after_reset ------------------------------------------
-------------------------------------------------------- SETUP --------------------------------------------------------
2026-02-10T11:51:11.025694 conftest INFO Executing function fixture: term_handler_scope_function
2026-02-10T11:51:11.025986 conftest INFO Executing function fixture: autouse_fixtures
2026-02-10T11:51:54.404337 tests.virt.node.general.test_vmi_reset_comprehensive INFO Pod after reset: name=virt-launcher-vm-for-reset-test-1770724056-0795608-trpkz, uid=69c12e2c-27cf-4e62-a808-781451b15249
.
TEST: TestVMIReset.test_vmi_pod_unchanged_after_reset STATUS: PASSED
------------------------------------------------------- TEARDOWN -------------------------------------------------------

______________________________________________________ 4 of 12 completed, 4 Pass, 0 Fail, 0 Skip, 0 XPass, 0 XFail, 0 Error, 0 ReRun _______________________________________________________

tests/virt/node/general/test_vmi_reset_comprehensive.py 
------------------------------------------ test_boot_time_changes_after_reset ------------------------------------------
-------------------------------------------------------- SETUP --------------------------------------------------------
2026-02-10T11:51:54.408404 conftest INFO Executing function fixture: term_handler_scope_function
2026-02-10T11:51:54.408839 conftest INFO Executing function fixture: autouse_fixtures
2026-02-10T11:52:37.456234 tests.virt.node.general.test_vmi_reset_comprehensive INFO Boot count after reset: 7
.
______________________________________________________ 5 of 12 completed, 5 Pass, 0 Fail, 0 Skip, 0 XPass, 0 XFail, 0 Error, 0 ReRun _______________________________________________________

tests/virt/node/general/test_vmi_reset_comprehensive.py --------------------------------------------------------- CALL ---------------------------------------------------------
2026-02-10T11:53:39.482162 tests.virt.node.general.test_vmi_reset_comprehensive INFO Creating client impersonating service account vmi-reset-edit-sa
F

TEST: TestVMIResetRBAC.test_user_with_edit_role_can_reset_vmi STATUS: FAILED

_________________________________________________________________ TestVMIResetRBAC.test_user_with_edit_role_can_reset_vmi __________________________________________________________________

self = <tests.virt.node.general.test_vmi_reset_comprehensive.TestVMIResetRBAC object at 0x7facdf63ca50>
running_fedora_vm = <utilities.virt.VirtualMachineForTests object at 0x7facde0fdd30>
service_account_with_edit_role = <ocp_resources.service_account.ServiceAccount object at 0x7facde0f5590>, namespace = <ocp_resources.namespace.Namespace object at 0x7facde27eb10>

    @pytest.mark.polarion("CNV-12378")
    def test_user_with_edit_role_can_reset_vmi(
        self,
        running_fedora_vm,
        service_account_with_edit_role,
        namespace,
    ):
        """
        Test that a user with 'edit' role can successfully reset a VMI.
    
        Steps:
            1. Create client impersonating service account with 'edit' role
            2. Execute reset operation on VMI via API using impersonated client
    
        Expected:
            - Reset operation succeeds without authorization error
        """
        LOGGER.info(f"Creating client impersonating service account {service_account_with_edit_role.name}")
        sa_client = get_client(
            config_file=None,
>           token=service_account_with_edit_role.get_sa_token(),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
E       AttributeError: 'ServiceAccount' object has no attribute 'get_sa_token'

tests/virt/node/general/test_vmi_reset_comprehensive.py:381: AttributeError
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------

---------------------------------------- test_user_with_edit_role_can_reset_vmi ----------------------------------------
-------------------------------------------------------- SETUP --------------------------------------------------------
2026-02-10T11:52:46.784133 conftest INFO Executing function fixture: term_handler_scope_function
2026-02-10T11:52:46.784326 conftest INFO Executing class fixture: term_handler_scope_class
2026-02-10T11:52:46.784653 conftest INFO Executing function fixture: autouse_fixtures
2026-02-10T11:52:46.784991 conftest INFO Executing class fixture: running_fedora_vm
2026-02-10T11:52:46.787257 ocp_resources.resource INFO Trying to get client via new_client_from_config --- [DuplicateFilter: Last log `kind: VirtualMachineInstance api version: kubevirt.io/v1` repeated 28 times]
2026-02-10T11:52:46.890993 ocp_resources.resource INFO kind: VirtualMachine api version: kubevirt.io/v1
2026-02-10T11:52:46.891263 utilities.virt WARNING `os_login_param` not defined for fedora
2026-02-10T11:52:46.949012 ocp_resources VirtualMachine INFO Create VirtualMachine vm-for-reset-test-1770724366-8908286
2026-02-10T11:52:46.949395 ocp_resources VirtualMachine INFO Posting {'apiVersion': 'kubevirt.io/v1', 'kind': 'VirtualMachine', 'metadata': {'creationTimestamp': None, 'labels': {'kubevirt.io/vm': 'vm-for-reset-test'}, 'name': 'vm-for-reset-test-1770724366-8908286'}, 'spec': {'template': {'metadata': {'creationTimestamp': None, 'labels': {'kubevirt.io/vm': 'vm-for-reset-test-1770724366-8908286', 'kubevirt.io/domain': 'vm-for-reset-test-1770724366-8908286', 'debugLogs': 'true'}}, 'spec': {'domain': {'cpu': {'cores': 1}, 'memory': {'guest': '1Gi'}, 'devices': {'disks': [{'disk': {'bus': 'virtio'}, 'name': 'containerdisk'}, {'disk': {'bus': 'virtio'}, 'name': 'cloudinitdisk'}], 'interfaces': [{'masquerade': {}, 'name': 'default'}], 'rng': {}}, 'machine': {'type': ''}}, 'networks': [{'name': 'default', 'pod': {}}], 'terminationGracePeriodSeconds': 30, 'volumes': [{'containerDisk': {'image': 'quay.io/openshift-cnv/qe-cnv-tests-fedora:41@sha256:a91659fba4e0258dda1be076dd6e56e34d9bf3dce082e57f939994ce0f124348'}, 'name': 'containerdisk'}, {'name': 'cloudinitdisk', 'cloudInitNoCloud': {'userData': '*******'}}]}}, 'runStrategy': 'Halted'}}
2026-02-10T11:52:46.899060 utilities.virt INFO Setting random username and password
2026-02-10T11:52:47.152831 timeout_sampler INFO Waiting for 5 seconds [0:00:05], retry every 1 seconds. (Function: utilities.virt.<locals>.lambda: vm.instance.get)
2026-02-10T11:52:47.167715 timeout_sampler INFO Elapsed time: 0.00027441978454589844 [0:00:00.000274]
2026-02-10T11:52:47.168011 ocp_resources.resource INFO kind: VirtualMachineInstance api version: kubevirt.io/v1
2026-02-10T11:52:47.168129 ocp_resources VirtualMachineInstance INFO Wait for VirtualMachineInstance vm-for-reset-test-1770724366-8908286 status to be Running
2026-02-10T11:52:47.168295 timeout_sampler INFO Waiting for 240 seconds [0:04:00], retry every 1 seconds. (Function: ocp_resources.resource.wait_for_status.lambda: self.exists)
2026-02-10T11:52:48.183331 ocp_resources VirtualMachineInstance INFO Status of VirtualMachineInstance vm-for-reset-test-1770724366-8908286 is Scheduling
2026-02-10T11:52:56.257727 ocp_resources VirtualMachineInstance INFO Status of VirtualMachineInstance vm-for-reset-test-1770724366-8908286 is Scheduled
2026-02-10T11:53:00.290861 ocp_resources VirtualMachineInstance INFO Status of VirtualMachineInstance vm-for-reset-test-1770724366-8908286 is Running
2026-02-10T11:53:00.291099 timeout_sampler INFO Elapsed time: 13.114286422729492 [0:00:13.114286]
2026-02-10T11:53:00.291897 ocp_resources VirtualMachineInstance INFO Wait for VirtualMachineInstance/vm-for-reset-test-1770724366-8908286's 'AgentConnected' condition to be 'True'
2026-02-10T11:53:00.292111 ocp_resources VirtualMachineInstance INFO Wait until VirtualMachineInstance vm-for-reset-test-1770724366-8908286 is created
2026-02-10T11:53:00.292758 timeout_sampler INFO Waiting for 720 seconds [0:12:00], retry every 1 seconds. (Function: ocp_resources.resource.wait.lambda: self.exists)
2026-02-10T11:53:00.291700 utilities.virt INFO Wait until guest agent is active on vm-for-reset-test-1770724366-8908286
2026-02-10T11:53:00.300287 timeout_sampler INFO Elapsed time: 0.00015616416931152344 [0:00:00.000156]
2026-02-10T11:53:00.300629 timeout_sampler INFO Waiting for 719.9914655685425 seconds [0:11:59.991466], retry every 1 seconds. (Function: ocp_resources.resource.wait_for_condition.lambda: self.instance)
2026-02-10T11:53:38.694930 timeout_sampler INFO Elapsed time: 38.385860204696655 [0:00:38.385860]
2026-02-10T11:53:38.696602 timeout_sampler INFO Waiting for 720 seconds [0:12:00], retry every 1 seconds. (Function: utilities.virt.<locals>.lambda: vmi.instance)
2026-02-10T11:53:38.696399 utilities.virt INFO Wait for vm-for-reset-test-1770724366-8908286 network interfaces
2026-02-10T11:53:38.703966 timeout_sampler INFO Elapsed time: 0.0003209114074707031 [0:00:00.000321]
2026-02-10T11:53:38.704209 utilities.virt INFO Wait for vm-for-reset-test-1770724366-8908286 SSH connectivity.
2026-02-10T11:53:38.704308 utilities.virt INFO SSH command: ssh -o 'ProxyCommand=virtctl port-forward --stdio=true vm/vm-for-reset-test-1770724366-8908286/node-general-test-vmi-reset-comprehensive 22' qeNkPAHRWSllpfbt@vm-for-reset-test-1770724366-8908286
2026-02-10T11:53:38.716602 timeout_sampler INFO Waiting for 120 seconds [0:02:00], retry every 5 seconds. (Function: rrmngmnt.host.run_command  Kwargs: {'command': ['exit'], 'tcp_timeout': 60})
2026-02-10T11:53:38.716788 Host INFO [vm-for-reset-test-1770724366-8908286] Executing command exit
2026-02-10T11:53:38.865564 paramiko.transport INFO Connected (version 2.0, client OpenSSH_9.8)
2026-02-10T11:53:38.912398 paramiko.transport INFO Authentication (publickey) successful!
2026-02-10T11:53:39.332751 timeout_sampler INFO Elapsed time: 0.000213623046875 [0:00:00.000214]
2026-02-10T11:53:39.334394 ocp_resources ServiceAccount INFO Create ServiceAccount vmi-reset-edit-sa
2026-02-10T11:53:39.334960 ocp_resources ServiceAccount INFO Posting {'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'vmi-reset-edit-sa', 'namespace': 'node-general-test-vmi-reset-comprehensive'}}
2026-02-10T11:53:39.333212 conftest INFO Executing class fixture: service_account_with_edit_role
2026-02-10T11:53:39.362750 ocp_resources.resource INFO kind: RoleBinding api version: rbac.authorization.k8s.io/v1
2026-02-10T11:53:39.363016 ocp_resources RoleBinding INFO Create RoleBinding vmi-reset-edit-sa-edit-binding
2026-02-10T11:53:39.363213 ocp_resources RoleBinding INFO Posting {'apiVersion': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'metadata': {'name': 'vmi-reset-edit-sa-edit-binding', 'namespace': 'node-general-test-vmi-reset-comprehensive'}, 'subjects': [{'kind': 'ServiceAccount', 'name': 'vmi-reset-edit-sa'}], 'roleRef': {'kind': 'ClusterRole', 'name': 'edit', 'apiGroup': 'rbac.authorization.k8s.io'}}
2026-02-10T11:53:39.400785 ocp_resources ServiceAccount INFO Create ServiceAccount vmi-reset-view-sa
2026-02-10T11:53:39.400936 ocp_resources ServiceAccount INFO Posting {'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'vmi-reset-view-sa', 'namespace': 'node-general-test-vmi-reset-comprehensive'}}
2026-02-10T11:53:39.400324 conftest INFO Executing class fixture: service_account_without_reset_permission
2026-02-10T11:53:39.414279 ocp_resources RoleBinding INFO Create RoleBinding vmi-reset-view-sa-view-binding
2026-02-10T11:53:39.414437 ocp_resources RoleBinding INFO Posting {'apiVersion': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'metadata': {'name': 'vmi-reset-view-sa-view-binding', 'namespace': 'node-general-test-vmi-reset-comprehensive'}, 'subjects': [{'kind': 'ServiceAccount', 'name': 'vmi-reset-view-sa'}], 'roleRef': {'kind': 'ClusterRole', 'name': 'view', 'apiGroup': 'rbac.authorization.k8s.io'}}
self = <tests.virt.node.general.test_vmi_reset_comprehensive.TestVMIResetRBAC object at 0x7facdf63ca50>
running_fedora_vm = <utilities.virt.VirtualMachineForTests object at 0x7facde0fdd30>
service_account_with_edit_role = <ocp_resources.service_account.ServiceAccount object at 0x7facde0f5590>, namespace = <ocp_resources.namespace.Namespace object at 0x7facde27eb10>

    @pytest.mark.polarion("CNV-12378")
    def test_user_with_edit_role_can_reset_vmi(
        self,
        running_fedora_vm,
        service_account_with_edit_role,
        namespace,
    ):
        """
        Test that a user with 'edit' role can successfully reset a VMI.
    
        Steps:
            1. Create client impersonating service account with 'edit' role
            2. Execute reset operation on VMI via API using impersonated client
    
        Expected:
            - Reset operation succeeds without authorization error
        """
        LOGGER.info(f"Creating client impersonating service account {service_account_with_edit_role.name}")
        sa_client = get_client(
            config_file=None,
>           token=service_account_with_edit_role.get_sa_token(),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
E       AttributeError: 'ServiceAccount' object has no attribute 'get_sa_token'

tests/virt/node/general/test_vmi_reset_comprehensive.py:381: AttributeError
------------------------------------------------------- TEARDOWN -------------------------------------------------------
______________________________________________________ 6 of 12 completed, 5 Pass, 1 Fail, 0 Skip, 0 XPass, 0 XFail, 0 Error, 0 ReRun _______________________________________________________

tests/virt/node/general/test_vmi_reset_comprehensive.py 
--------------------------------- test_user_without_reset_permission_cannot_reset_vmi ---------------------------------
-------------------------------------------------------- SETUP --------------------------------------------------------
2026-02-10T11:53:39.716018 conftest INFO Executing function fixture: term_handler_scope_function
2026-02-10T11:53:39.716356 conftest INFO Executing function fixture: autouse_fixtures
--------------------------------------------------------- CALL ---------------------------------------------------------
2026-02-10T11:53:39.717741 tests.virt.node.general.test_vmi_reset_comprehensive INFO Creating client impersonating service account vmi-reset-view-sa
F

TEST: TestVMIResetRBAC.test_user_without_reset_permission_cannot_reset_vmi STATUS: FAILED

___________________________________________________________ TestVMIResetRBAC.test_user_without_reset_permission_cannot_reset_vmi ___________________________________________________________

self = <tests.virt.node.general.test_vmi_reset_comprehensive.TestVMIResetRBAC object at 0x7facdf63ccd0>
running_fedora_vm = <utilities.virt.VirtualMachineForTests object at 0x7facde0fdd30>
service_account_without_reset_permission = <ocp_resources.service_account.ServiceAccount object at 0x7facde0f5d10>, namespace = <ocp_resources.namespace.Namespace object at 0x7facde27eb10>

    @pytest.mark.polarion("CNV-12379")
    def test_user_without_reset_permission_cannot_reset_vmi(
        self,
        running_fedora_vm,
        service_account_without_reset_permission,
        namespace,
    ):
        """
        [NEGATIVE] Test that a user without reset permission cannot reset a VMI.
    
        Steps:
            1. Create client impersonating service account without reset permission
            2. Attempt to execute reset operation on VMI via API
    
        Expected:
            - Reset operation fails with HTTP 403 Forbidden error
        """
        LOGGER.info(
            f"Creating client impersonating service account {service_account_without_reset_permission.name}"
        )
        sa_client = get_client(
            config_file=None,
>           token=service_account_without_reset_permission.get_sa_token(),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
E       AttributeError: 'ServiceAccount' object has no attribute 'get_sa_token'

tests/virt/node/general/test_vmi_reset_comprehensive.py:420: AttributeError
______________________________________________________ 7 of 12 completed, 5 Pass, 2 Fail, 0 Skip, 0 XPass, 0 XFail, 0 Error, 0 ReRun _______________________________________________________

tests/virt/node/general/test_vmi_reset_comprehensive.py E
TEST: TestVMIResetErrorHandling.test_reset_stopped_vmi_fails [setup] STATUS: ERROR


_________________________________________________________ ERROR at setup of TestVMIResetErrorHandling.test_reset_stopped_vmi_fails _________________________________________________________

func = <bound method ApiClient.request of <kubernetes.client.api_client.ApiClient object at 0x7facdf701940>>
exceptions_dict = {<class 'urllib3.exceptions.MaxRetryError'>: [], <class 'ConnectionAbortedError'>: [], <class 'ConnectionResetError'>:...eader changed', 'etcdserver: request timed out', 'Internal error occurred: failed calling webhook', 'rpc error:'], ...}
timeout = 30, sleep_time = 5
kwargs = {'headers': {'Content-Type': 'application/json', 'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9...amespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop'}
sampler = <timeout_sampler.TimeoutSampler object at 0x7faccc72bf70>

    @staticmethod
    def retry_cluster_exceptions(
        func: Callable,
        exceptions_dict: dict[type[Exception], list[str]] = DEFAULT_CLUSTER_RETRY_EXCEPTIONS,
        timeout: int = TIMEOUT_10SEC,
        sleep_time: int = 1,
        **kwargs: Any,
    ) -> Any:
        try:
            sampler = TimeoutSampler(
                wait_timeout=timeout,
                sleep=sleep_time,
                func=func,
                print_log=False,
                exceptions_dict=exceptions_dict,
                **kwargs,
            )
>           for sample in sampler:
                          ^^^^^^^

.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1147: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <timeout_sampler.TimeoutSampler object at 0x7faccc72bf70>

    def __iter__(self) -> Any:
        """
        Call `func` and yield the result, or raise an exception on timeout.
    
        Yields:
            any: Return value from `func`
    
        Raises:
            TimeoutExpiredError: if `func` takes longer than `wait_timeout` seconds to return a value
        """
        timeout_watch = TimeoutWatch(timeout=self.wait_timeout)
        if self.print_log:
            log = (
                f"Waiting for {self.wait_timeout} seconds"
                f" [{datetime.timedelta(seconds=self.wait_timeout)}], retry every"
                f" {self.sleep} seconds."
            )
    
            if self.print_func_log:
                log += f" ({self._func_log})"
    
            LOGGER.info(log)
    
        last_exp = None
        elapsed_timee= None
        while timeout_watch.remaining_time() > 0:
            try:
                elapsed_time = self.wait_timeout - timeout_watch.remaining_time()
                yield self.func(*self.func_args, **self.func_kwargs)
                time.sleep(self.sleep)
                elapsed_time = None
    
            except Exception as exp:
                last_exp = exp
                elapsed_time = self.wait_timeout - timeout_watch.remaining_time()
    
                if not self._should_ignore_exception(exp=last_exp):
>                   raise TimeoutExpiredError(
                        self._get_exception_log(exp=last_exp), last_exp=last_exp, elapsed_time=elapsed_time
                    )
E                   timeout_sampler.TimeoutExpiredError: Timed Out: 30
E                   Function: kubernetes.client.api_client.request  Kwargs: {'url': 'https://api.c01-mv-421.rhos-psi.cnv-qe.rhood.us:6443/apis/subresources.kubevirt.io/v1/namespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop', 'method': 'PUT', 'headers': {'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9b-f8PI', 'Content-Type': 'application/json'}}
E                   Last exception: ApiException: (409)
E                   Reason: Conflict
E                   HTTP response headers: HTTPHeaderDict({'Audit-Id': 'a908927a-e8fc-4e38-b1cb-d87ccb78bbbb', 'Cache-Control': 'no-cache, private', 'Content-Length': '390', 'Content-Type': 'application/json', 'Date': 'Tue, 10 Feb 2026 11:53:47 GMT', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Kubernetes-Pf-Flowschema-Uid': 'cc44f062-8f4c-4bd6-ae9c-c57c3a743560', 'X-Kubernetes-Pf-Prioritylevel-Uid': 'e328d015-75e1-4f90-8939-9355d8687b43'})
E                   HTTP response body: {
E                    "kind": "Status",
E                    "apiVersion": "v1",
E                    "metadata": {},
E                    "status": "Failure",
E                    "message": "Operation cannot be fulfilled on virtualmachine.kubevirt.io \"vm-stopped-for-reset-test-1770724427-2696245\": VM is not running",
E                    "reason": "Conflict",
E                    "details": {
E                     "name": "vm-stopped-for-reset-test-1770724427-2696245",
E                     "group": "kubevirt.io",
E                     "kind": "virtualmachine"
E                    },
E                    "code": 409
E                   }
E                   .
E                   Elapsed time: 0.036036014556884766 [0:00:00.036036]

.venv/lib/python3.14/site-packages/timeout_sampler/__init__.py:171: TimeoutExpiredError

The above exception was the direct cause of the following exception:

unprivileged_client = <kubernetes.dynamic.client.DynamicClient object at 0x7facdf702520>, namespace = <ocp_resources.namespace.Namespace object at 0x7facde27eb10>

    @pytest.fixture(scope="class")
    def stopped_fedora_vm(unprivileged_client, namespace):
        """
        Stopped Fedora VirtualMachine for negative testing.
    
        Yields:
            VirtualMachine: Stopped VM
        """
        name = "vm-stopped-for-reset-test"
        with VirtualMachineForTests(
            client=unprivileged_client,
            name=name,
            namespace=namespace.name,
            body=fedora_vm_body(name=name),
        ) as vm:
>           vm.stop(wait=True)

tests/virt/node/general/test_vmi_reset_comprehensive.py:90: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.14/site-packages/ocp_resources/virtual_machine.py:105: in stop
    self.api_request(method="PUT", action="stop")
.venv/lib/python3.14/site-packages/ocp_resources/virtual_machine.py:79: in api_request
    return super().api_request(
.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1337: in api_request
    response = self.retry_cluster_exceptions(
.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1152: in retry_cluster_exceptions
    raise exp.last_exp from exp
.venv/lib/python3.14/site-packages/timeout_sampler/__init__.py:162: in __iter__
    yield self.func(*self.func_args, **self.func_kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.14/site-packages/kubernetes/client/api_client.py:399: in request
    return self.rest_client.PUT(url,
.venv/lib/python3.14/site-packages/kubernetes/client/rest.py:289: in PUT
    return self.request("PUT", url,
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <kubernetes.client.rest.RESTClientObject object at 0x7facdf702b10>, method = 'PUT'
url = 'https://api.c01-mv-421.rhos-psi.cnv-qe.rhood.us:6443/apis/subresources.kubevirt.io/v1/namespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop'
query_params = None, headers = {'Content-Type': 'application/json', 'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9b-f8PI'}, body = None, post_params = {}
_preload_content = True, _request_timeout = None

    def request(self, method, url, query_params=None, headers=None,
                body=None, post_params=None, _preload_content=True,
                _request_timeout=None):
        """Perform requests.
    
        :param method: http request method
        :param url: http request url
        :param query_params: query parameters in the url
        :param headers: http request headers
        :param body: request json body, for `application/json`
        :param post_params: request post parameters,
                            `application/x-www-form-urlencoded`
                            and `multipart/form-data`
        :param _preload_content: if False, the urllib3.HTTPResponse object will
                                 be returned without reading/decoding response
                                 data. Default is True.
        :param _request_timeout: timeout setting for this request. If one
                                 number provided, it will be total request
                                 timeout. It can also be a pair (tuple) of
                                 (connection, read) timeouts.
        """
        method = method.upper()
        assert method in ['GET', 'HEAD', 'DELETE', 'POST', 'PUT',
                          'PATCH', 'OPTIONS']
    
        if post_params and body:
            raise ApiValueError(
                "body parameter cannot be used with post_params parameter."
            )
    
        post_params = post_params or {}
        headers = headers or {}
    
        timeout = None
        if _request_timeout:
            if isinstance(_request_timeout, (int, ) if six.PY3 else (int, long)):  # noqa: E501,F821
                timeout = urllib3.Timeout(total=_request_timeout)
            elif (isinstance(_request_timeout, tuple) and
                  len(_request_timeout) == 2):
                timeout = urllib3.Timeout(
                    connect=_request_timeout[0], read=_request_timeout[1])
    
        if 'Content-Type' not in headers:
            headers['Content-Type'] = 'application/json'
    
        try:
            # For `POST`, `PUT`, `PATCH`, `OPTIONS`, `DELETE`
            if method in ['POST', 'PUT', 'PATCH', 'OPTIONS', 'DELETE']:
                if query_params:
                    url += '?' + urlencode(query_params)
                if (re.search('json', headers['Content-Type'], re.IGNORECASE) or
                        headers['Content-Type'] == 'application/apply-patch+yaml'):
                    if headers['Content-Type'] == 'application/json-patch+json':
                        if not isinstance(body, list):
                            headers['Content-Type'] = \
                                'application/strategic-merge-patch+json'
                    request_body = None
                    if body is not None:
                        request_body = json.dumps(body)
                    r = self.pool_manager.request(
                        method, url,
                        body=request_body,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                elif headers['Content-Type'] == 'application/x-www-form-urlencoded':  # noqa: E501
                    r = self.pool_manager.request(
                        method, url,
                        fields=post_params,
                        encode_multipart=False,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                elif headers['Content-Type'] == 'multipart/form-data':
                    # must del headers['Content-Type'], or the correct
                    # Content-Type which generated by urllib3 will be
                    # overwritten.
                    del headers['Content-Type']
                    r = self.pool_manager.request(
                        method, url,
                        fields=post_params,
                        encode_multipart=True,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                # Pass a `string` parameter directly in the body to support
                # other content types than Json when `body` argument is
                # provided in serialized form
                elif isinstance(body, str) or isinstance(body, bytes):
                    request_body = body
                    r = self.pool_manager.request(
                        method, url,
                        body=request_body,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                else:
                    # Cannot generate the request from given parameters
                    msg = """Cannot prepare a request message for provided
                             arguments. Please check that your arguments match
                             declared content type."""
                    raise ApiException(status=0, reason=msg)
            # For `GET`, `HEAD`
            else:
                r = self.pool_manager.request(method, url,
                                              fields=query_params,
                                              preload_content=_preload_content,
                                              timeout=timeout,
                                              headers=headers)
        except urllib3.exceptions.SSLError as e:
            msg = "{0}\n{1}".format(type(e).__name__, str(e))
            raise ApiException(status=0, reason=msg)
    
        if _preload_content:
            r = RESTResponse(r)
    
            # In the python 3, the response.data is bytes.
            # we need to decode it to string.
            if six.PY3:
                r.data = r.data.decode('utf8')
    
            # log response body
            logger.debug("response body: %s", r.data)
    
        if not 200 <= r.status <= 299:
>           raise ApiException(http_resp=r)
E           kubernetes.client.exceptions.ApiException: (409)
E           Reason: Conflict
E           HTTP response headers: HTTPHeaderDict({'Audit-Id': 'a908927a-e8fc-4e38-b1cb-d87ccb78bbbb', 'Cache-Control': 'no-cache, private', 'Content-Length': '390', 'Content-Type': 'application/json', 'Date': 'Tue, 10 Feb 2026 11:53:47 GMT', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Kubernetes-Pf-Flowschema-Uid': 'cc44f062-8f4c-4bd6-ae9c-c57c3a743560', 'X-Kubernetes-Pf-Prioritylevel-Uid': 'e328d015-75e1-4f90-8939-9355d8687b43'})
E           HTTP response body: {
E            "kind": "Status",
E            "apiVersion": "v1",
E            "metadata": {},
E            "status": "Failure",
E            "message": "Operation cannot be fulfilled on virtualmachine.kubevirt.io \"vm-stopped-for-reset-test-1770724427-2696245\": VM is not running",
E            "reason": "Conflict",
E            "details": {
E             "name": "vm-stopped-for-reset-test-1770724427-2696245",
E             "group": "kubevirt.io",
E             "kind": "virtualmachine"
E            },
E            "code": 409
E           }

.venv/lib/python3.14/site-packages/kubernetes/client/rest.py:238: ApiException
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------

--------------------------------------------- test_reset_stopped_vmi_fails ---------------------------------------------
-------------------------------------------------------- SETUP --------------------------------------------------------
2026-02-10T11:53:47.164523 conftest INFO Executing function fixture: term_handler_scope_function
2026-02-10T11:53:47.164718 conftest INFO Executing class fixture: term_handler_scope_class
2026-02-10T11:53:47.165015 conftest INFO Executing function fixture: autouse_fixtures
2026-02-10T11:53:47.165415 conftest INFO Executing class fixture: stopped_fedora_vm
2026-02-10T11:53:47.167471 ocp_resources.resource INFO Trying to get client via new_client_from_config
2026-02-10T11:53:47.269799 ocp_resources.resource INFO kind: VirtualMachine api version: kubevirt.io/v1
2026-02-10T11:53:47.270016 utilities.virt WARNING `os_login_param` not defined for fedora
2026-02-10T11:53:47.277357 utilities.virt INFO Setting random username and password
2026-02-10T11:53:47.325474 ocp_resources VirtualMachine INFO Create VirtualMachine vm-stopped-for-reset-test-1770724427-2696245
2026-02-10T11:53:47.325666 ocp_resources VirtualMachine INFO Posting {'apiVersion': 'kubevirt.io/v1', 'kind': 'VirtualMachine', 'metadata': {'creationTimestamp': None, 'labels': {'kubevirt.io/vm': 'vm-stopped-for-reset-test'}, 'name': 'vm-stopped-for-reset-test-1770724427-2696245'}, 'spec': {'template': {'metadata': {'creationTimestamp': None, 'labels': {'kubevirt.io/vm': 'vm-stopped-for-reset-test-1770724427-2696245', 'kubevirt.io/domain': 'vm-stopped-for-reset-test-1770724427-2696245', 'debugLogs': 'true'}}, 'spec': {'domain': {'cpu': {'cores': 1}, 'memory': {'guest': '1Gi'}, 'devices': {'disks': [{'disk': {'bus': 'virtio'}, 'name': 'containerdisk'}, {'disk': {'bus': 'virtio'}, 'name': 'cloudinitdisk'}], 'interfaces': [{'masquerade': {}, 'name': 'default'}], 'rng': {}}, 'machine': {'type': ''}}, 'networks': [{'name': 'default', 'pod': {}}], 'terminationGracePeriodSeconds': 30, 'volumes': [{'containerDisk': {'image': 'quay.io/openshift-cnv/qe-cnv-tests-fedora:41@sha256:a91659fba4e0258dda1be076dd6e56e34d9bf3dce082e57f939994ce0f124348'}, 'name': 'containerdisk'}, {'name': 'cloudinitdisk', 'cloudInitNoCloud': {'userData': '*******'}}]}}, 'runStrategy': 'Halted'}}
2026-02-10T11:53:47.408494 ocp_resources VirtualMachine INFO Delete VirtualMachine vm-stopped-for-reset-test-1770724427-2696245
2026-02-10T11:53:47.424444 ocp_resources VirtualMachine INFO Deleting {'apiVersion': 'kubevirt.io/v1', 'kind': 'VirtualMachine', 'metadata': {'annotations': {'kubemacpool.io/transaction-timestamp': '2026-02-10T11:53:47.339958306Z'}, 'creationTimestamp': '2026-02-10T11:53:47Z', 'generation': 1, 'labels': {'kubevirt.io/vm': 'vm-stopped-for-reset-test'}, 'managedFields': [{'apiVersion': 'kubevirt.io/v1', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:metadata': {'f:labels': {'.': {}, 'f:kubevirt.io/vm': {}}}, 'f:spec': {'.': {}, 'f:runStrategy': {}, 'f:template': {'.': {}, 'f:metadata': {'.': {}, 'f:creationTimestamp': {}, 'f:labels': {'.': {}, 'f:debugLogs': {}, 'f:kubevirt.io/domain': {}, 'f:kubevirt.io/vm': {}}}, 'f:spec': {'.': {}, 'f:domain': {'.': {}, 'f:cpu': {'.': {}, 'f:cores': {}}, 'f:devices': {'.': {}, 'f:disks': {}, 'f:interfaces': {}, 'f:rng': {}}, 'f:machine': {'.': {}, 'f:type': {}}, 'f:memory': {'.': {}, 'f:guest': {}}}, 'f:networks': {}, 'f:terminationGracePeriodSeconds': {}, 'f:volumes': {}}}}}, 'manager': 'OpenAPI-Generator', 'operation': 'Update', 'time': '2026-02-10T11:53:47Z'}, {'apiVersion': 'kubevirt.io/v1', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:status': {'.': {}, 'f:printableStatus': {}, 'f:volumeSnapshotStatuses': {}}}, 'manager': 'virt-controller', 'operation': 'Update', 'subresource': 'status', 'time': '2026-02-10T11:53:47Z'}], 'name': 'vm-stopped-for-reset-test-1770724427-2696245', 'namespace': 'node-general-test-vmi-reset-comprehensive', 'resourceVersion': '6310231', 'uid': 'f915553e-7f1b-4ecf-85bd-dca91bb9c0e8'}, 'spec': {'runStrategy': 'Halted', 'template': {'metadata': {'creationTimestamp': None, 'labels': {'debugLogs': 'true', 'kubevirt.io/domain': 'vm-stopped-for-reset-test-1770724427-2696245', 'kubevirt.io/vm': 'vm-stopped-for-reset-test-1770724427-2696245'}}, 'spec': {'architecture': 'amd64', 'domain': {'cpu': {'cores': 1}, 'devices': {'disks': [{'disk': {'bus': 'virtio'}, 'name': 'containerdisk'}, {'disk': {'bus': 'virtio'}, 'name': 'cloudinitdisk'}], 'interfaces': [{'macAddress': '02:22:9f:48:8e:02', 'masquerade': {}, 'name': 'default'}], 'rng': {}}, 'firmware': {'serial': 'c9d2a109-2394-4812-ae3d-d6efdbd87616', 'uuid': '95101af9-9366-4d4e-9875-982aa7026e2c'}, 'machine': {'type': 'pc-q35-rhel9.6.0'}, 'memory': {'guest': '1Gi'}, 'resources': {}}, 'networks': [{'name': 'default', 'pod': {}}], 'terminationGracePeriodSeconds': 30, 'volumes': [{'containerDisk': {'image': 'quay.io/openshift-cnv/qe-cnv-tests-fedora:41@sha256:a91659fba4e0258dda1be076dd6e56e34d9bf3dce082e57f939994ce0f124348'}, 'name': 'containerdisk'}, {'cloudInitNoCloud': {'userData': '*******'}, 'name': 'cloudinitdisk'}]}}}, 'status': {'printableStatus': 'Stopped', 'volumeSnapshotStatuses': [{'enabled': False, 'name': 'containerdisk', 'reason': 'Snapshot is not supported for this volumeSource type [containerdisk]'}, {'enabled': False, 'name': 'cloudinitdisk', 'reason': 'Snapshot is not supported for this volumeSource type [cloudinitdisk]'}]}}
2026-02-10T11:53:47.465426 ocp_resources VirtualMachine INFO Wait until VirtualMachine vm-stopped-for-reset-test-1770724427-2696245 is deleted
2026-02-10T11:53:47.465607 timeout_sampler INFO Waiting for 240 seconds [0:04:00], retry every 1 seconds. (Function: ocp_resources.resource.wait_deleted.lambda: self.exists)
2026-02-10T11:53:48.482792 timeout_sampler INFO Elapsed time: 1.0091767311096191 [0:00:01.009177]
______________________________________________________ 8 of 12 completed, 5 Pass, 2 Fail, 0 Skip, 0 XPass, 0 XFail, 1 Error, 0 ReRun _______________________________________________________

func = <bound method ApiClient.request of <kubernetes.client.api_client.ApiClient object at 0x7facdf701940>>
exceptions_dict = {<class 'urllib3.exceptions.MaxRetryError'>: [], <class 'ConnectionAbortedError'>: [], <class 'ConnectionResetError'>:...eader changed', 'etcdserver: request timed out', 'Internal error occurred: failed calling webhook', 'rpc error:'], ...}
timeout = 30, sleep_time = 5
kwargs = {'headers': {'Content-Type': 'application/json', 'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9...amespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop'}
sampler = <timeout_sampler.TimeoutSampler object at 0x7faccc72bf70>

    @staticmethod
    def retry_cluster_exceptions(
        func: Callable,
        exceptions_dict: dict[type[Exception], list[str]] = DEFAULT_CLUSTER_RETRY_EXCEPTIONS,
        timeout: int = TIMEOUT_10SEC,
        sleep_time: int = 1,
        **kwargs: Any,
    ) -> Any:
        try:
            sampler = TimeoutSampler(
                wait_timeout=timeout,
                sleep=sleep_time,
                func=func,
                print_log=False,
                exceptions_dict=exceptions_dict,
                **kwargs,
            )
>           for sample in sampler:
                          ^^^^^^^

.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1147: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <timeout_sampler.TimeoutSampler object at 0x7faccc72bf70>

    def __iter__(self) -> Any:
        """
        Call `func` and yield the result, or raise an exception on timeout.
    
        Yields:
            any: Return value from `func`
    
        Raises:
            TimeoutExpiredError: if `func` takes longer than `wait_timeout` seconds to return a value
        """
        timeout_watch = TimeoutWatch(timeout=self.wait_timeout)
        if self.print_log:
            log = (
                f"Waiting for {self.wait_timeout} seconds"
                f" [{datetime.timedelta(seconds=self.wait_timeout)}], retry every"
                f" {self.sleep} seconds."
            )
    
            if self.print_func_log:
                log += f" ({self._func_log})"
    
            LOGGER.info(log)
    
        last_exp = None
        elapsed_time = None
        while timeout_watch.remaining_time() > 0:
            try:
                elapsed_time = self.wait_timeout - timeout_watch.remaining_time()
                yield self.func(*self.func_args, **self.func_kwargs)
                time.sleep(self.sleep)
                elapsed_time = None
    
            except Exception as exp:
                last_exp = exp
                elapsed_time = self.wait_timeout - timeout_watch.remaining_time()
    
                if not self._should_ignore_exception(exp=last_exp):
>                   raise TimeoutExpiredError(
                        self._get_exception_log(exp=last_exp), last_exp=last_exp, elapsed_time=elapsed_time
                    )
E                   timeout_sampler.TimeoutExpiredError: Timed Out: 30
E                   Function: kubernetes.client.api_client.request  Kwargs: {'url': 'https://api.c01-mv-421.rhos-psi.cnv-qe.rhood.us:6443/apis/subresources.kubevirt.io/v1/namespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop', 'method': 'PUT', 'headers': {'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9b-f8PI', 'Content-Type': 'application/json'}}
E                   Last exception: ApiException: (409)
E                   Reason: Conflict
E                   HTTP response headers: HTTPHeaderDict({'Audit-Id': 'a908927a-e8fc-4e38-b1cb-d87ccb78bbbb', 'Cache-Control': 'no-cache, private', 'Content-Length': '390', 'Content-Type': 'application/json', 'Date': 'Tue, 10 Feb 2026 11:53:47 GMT', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Kubernetes-Pf-Flowschema-Uid': 'cc44f062-8f4c-4bd6-ae9c-c57c3a743560', 'X-Kubernetes-Pf-Prioritylevel-Uid': 'e328d015-75e1-4f90-8939-9355d8687b43'})
E                   HTTP response body: {
E                    "kind": "Status",
E                    "apiVersion": "v1",
E                    "metadata": {},
E                    "status": "Failure",
E                    "message": "Operation cannot be fulfilled on virtualmachine.kubevirt.io \"vm-stopped-for-reset-test-1770724427-2696245\": VM is not running",
E                    "reason": "Conflict",
E                    "details": {
E                     "name": "vm-stopped-for-reset-test-1770724427-2696245",
E                     "group": "kubevirt.io",
E                     "kind": "virtualmachine"
E                    },
E                    "code": 409
E                   }
E                   .
E                   Elapsed time: 0.036036014556884766 [0:00:00.036036]

.venv/lib/python3.14/site-packages/timeout_sampler/__init__.py:171: TimeoutExpiredError

The above exception was the direct cause of the following exception:

unprivileged_client = <kubernetes.dynamic.client.DyaamicClient object at 0x7facdf702520>, namespace = <ocp_resources.namespace.Namespace object at 0x7facde27eb10>

    @pytest.fixture(scope="class")
    def stopped_fedora_vm(unprivileged_client, namespace):
        """
        Stopped Fedora VirtualMachine for negative testing.
    
        Yields:
            VirtualMachine: Stopped VM
        """
        name = "vm-stopped-for-reset-test"
        with VirtualMachineForTests(
            client=unprivileged_client,
            name=name,
            namespace=namespace.name,
            body=fedora_vm_body(name=name),
        ) as vm:
>           vm.stop(wait=True)

tests/virt/node/general/test_vmi_reset_comprehensive.py:90: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.14/site-packages/ocp_resources/virtual_machine.py:105: in stop
    self.api_request(method="PUT", action="stop")
.venv/lib/python3.14/site-packages/ocp_resources/virtual_machine.py:79: in api_request
    return super().api_request(
.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1337: in api_request
    response = self.retry_cluster_exceptions(
.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1152: in retry_cluster_exceptions
    raise exp.last_exp from exp
.venv/lib/python3.14/site-packages/timeout_sampler/__init__.py:162: in __iter__
    yield self.func(*self.func_args, **self.func_kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.14/site-packages/kubernetes/client/api_client.py:399: in request
    return self.rest_client.PUT(url,
.venv/lib/python3.14/site-packages/kubernetes/client/rest.py:289: in PUT
    return self.request("PUT", url,
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <kubernetes.client.rest.RESTClientObject object at 0x7facdf702b10>, method = 'PUT'
url = 'https://api.c01-mv-421.rhos-psi.cnv-qe.rhood.us:6443/apis/subresources.kubevirt.io/v1/namespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop'
query_params = None, headers = {'Content-Type': 'application/json', 'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9b-f8PI'}, body = None, post_params = {}
_preload_content = True, _request_timeout = None

    def request(self, method, url, query_params=None, headers=None,
                body=None, post_params=None, _preload_content=True,
                _request_timeout=None):
        """Perform requests.
    
        :param method: http request method
        :param url: http request url
        :param query_params: query parameters in the url
        :param headers: http request headers
        :param body: request json body, for `application/json`
        :param post_params: request post parameters,
                            `application/x-www-form-urlencoded`
                            and `multipart/form-data`
        :param _preload_content: if False, the urllib3.HTTPResponse object will
                                 be returned without reading/decoding response
                                 data. Default is True.
        :param _request_timeout: timeout setting for this request. If one
                                 number provided, it will be total request
                                 timeout. It can also be a pair (tuple) of
                                 (connection, read) timeouts.
        """
        method = method.upper()
        assert method in ['GET', 'HEAD', 'DELETE', 'POST', 'PUT',
                          'PATCH', 'OPTIONS']
    
        if post_params and body:
            raise ApiValueError(
                "body parameter cannot be used with post_params parameter."
            )
    
        post_params = post_params or {}
        headers = headers or {}
    
        timeout = None
        if _request_timeout:
            if isinstance(_request_timeout, (int, ) if six.PY3 else (int, long)):  # noqa: E501,F821
                timeout = urllib3.Timeout(total=_request_timeout)
            elif (isinstance(_request_timeout, tuple) and
                  len(_request_timeout) == 2):
                timeout = urllib3.Timeout(
                    connect=_request_timeout[0], read=_request_timeout[1])
    
        if 'Content-Type' not in headers:
            headers['Content-Type'] = 'application/json'
    
        try:
            # For `POST`, `PUT`, `PATCH`, `OPTIONS`, `DELETE`
            if method in ['POST', 'PUT', 'PATCH', 'OPTIONS', 'DELETE']:
                if query_params:
                    url += '?' + urlencode(query_params)
                if (re.search('json', headers['Content-Type'], re.IGNORECASE) or
                        headers['Content-Type'] == 'application/apply-patch+yaml'):
                    if headers['Content-Type'] == 'application/json-patch+json':
                        if not isinstance(body, list):
                            headers['Content-Type'] = \
                                'application/strategic-merge-patch+json'
                    request_body = None
                    if body is not None:
                        request_body = json.dumps(body)
                    r = self.pool_manager.request(
                        method, url,
                        body=request_body,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                elif headers['Content-Type'] == 'application/x-www-form-urlencoded':  # noqa: E501
                    r = self.pool_manager.request(
                        method, url,
                        fields=post_params,
                        encode_multipart=False,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                elif headers['Content-Type'] == 'multipart/form-data':
                    # must del headers['Content-Type'], or the correct
                    # Content-Type which generated by urllib3 will be
                    # overwritten.
                    del headers['Content-Type']
                    r = self.pool_manager.request(
                        method, url,
                        fields=post_params,
                        encode_multipart=True,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                # Pass a `string` parameter directly in the body to support
                # other content types than Json when `body` argument is
                # provided in serialized form
                elif isinstance(body, str) or isinstance(body, bytes):
                    request_body = body
                    r = self.pool_manager.request(
                        method, url,
                        body=request_body,
                        prreload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                else:
                    # Cannot generate the request from given parameters
                    msg = """Cannot prepare a request message for provided
                             arguments. Please check that your arguments match
                             declared content type."""
                    raise ApiException(status=0, reason=msg)
            # For `GET`, `HEAD`
            else:
                r = self.pool_manager.request(method, url,
                                              fields=query_params,
                                              preload_content=_preload_content,
                                              timeout=timeout,
                                              headers=headers)
        except urllib3.exceptions.SSLError as e:
            msg = "{0}\n{1}".format(type(e).__name__, str(e))
            raise ApiException(status=0, reason=ms)
    
        if _preload_content:
            r = RESTResponse(r)
    
            # In the python 3, the response.data is bytes.
            # we need to decode it to string.
            if six.PY3:
                r.data = r.data.decode('utf8')
    
            # log response body
            logger.debug("response body: %s", r.data)
    
        if not 200 <= r.status <= 299:
>           raise ApiException(http_resp=r)
E           kubernetes.client.exceptions.ApiException: (409)
E           Reason: Conflict
E           HTTP response headers: HTTPHeaderDict({'Audit-Id': 'a908927a-e8fc-4e38-b1cb-d87ccb78bbbb', 'Cache-Control': 'no-cache, private', 'Content-Length': '390', 'Content-Type': 'application/json', 'Date': 'Tue, 10 Feb 2026 11:53:47 GMT', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Kubernetes-Pf-Flowschema-Uid': 'cc44f062-8f4c-4bd6-ae9c-c57c3a743560', 'X-Kubernetes-Pf-Prioritylevel-Uid': 'e328d015-75e1-4f90-8939-9355d8687b43'})
E           HTTP response body: {
E            "kind": "Status",
E            "apiVersion": "v1",
E            "metadata": {},
E            "status": "Failure",
E            "message": "Operation cannot be fulfilled on virtualmachine.kubevirt.io \"vm-stopped-for-reset-test-1770724427-2696245\": VM is not running",
E            "reason": "Conflict",
E            "details": {
E             "name": "vm-stopped-for-reset-test-1770724427-2696245",
E             "group": "kubevirt.io",
E             "kind": "virtualmachine"
E            },
E            "code": 409
E           }

.venv/lib/python3.14/site-packages/kubernetes/client/rest.py:238: ApiException
------------------------------------------------------- TEARDOWN -------------------------------------------------------
tests/virt/node/general/test_vmi_reset_comprehensive.py 
-------------------------------------------- test_reset_paused_vmi_behavior --------------------------------------------
-------------------------------------------------------- SETUP --------------------------------------------------------
2026-02-10T11:53:48.622418 conftest INFO Executing function fixture: term_handler_scope_function
2026-02-10T11:53:48.622872 conftest INFO Executing function fixture: autouse_fixtures
E
TEST: TestVMIResetErrorHandling.test_reset_paused_vmi_behavior [setup] STATUS: ERROR


________________________________________________________ ERROR at setup of TestVMIResetErrorHandling.test_reset_paused_vmi_behavior ________________________________________________________

func = <bound method ApiClient.request of <kubernetes.client.api_client.ApiClient object at 0x7facdf701940>>
exceptions_dict = {<class 'urllib3.exceptions.MaxRetryError'>: [], <class 'ConnectionAbortedError'>: [], <class 'ConnectionResetError'>:...eader changed', 'etcdserver: request timed out', 'Internal error occurred: failed calling webhook', 'rpc error:'], ...}
timeout = 30, sleep_time = 5
kwargs = {'headers': {'Content-Type': 'application/json', 'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9...amespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop'}
sampler = <timeout_sampler.TimeoutSampler object at 0x7faccc72bf70>

    @staticmethod
    def retry_cluster_exceptions(
        func: Callable,
        exceptions_dict: dict[type[Exception], list[str]] = DEFAULT_CLUSTER_RETRY_EXCEPTIONS,
        timeout: int = TIMEOUT_10SEC,
        sleep_time: int = 1,
        **kwargs: Any,
    ) -> Any:
        try:
            sampler = TimeoutSampler(
                wait_timeout=timeout,
                sleep=sleep_time,
                func=func,
                print_log=False,
                exceptions_dict=exceptions_dict,
                **kwargs,
            )
>           for sample in sampler:
                          ^^^^^^^

.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1147: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <timeout_sampler.TimeoutSampler object at 0x7faccc72bf70>

    def __iter__(self) -> Any:
        """
        Call `func` and yield the result, or raise an exception on timeout.
    
        Yields:
            any: Return value from `func`
    
        Raises:
            TimeoutExpiredError: if `func` takes longer than `wait_timeout` seconds to return a value
        """
        timeout_watch = TimeoutWatch(timeout=self.wait_timeout)
        if self.print_log:
            log = (
                f"Waiting for {self.wait_timeout} seconds"
                f" [{datetime.timedelta(seconds=self.wait_timeout)}], retry every"
                f" {self.sleep} seconds."
            )
    
            if self.print_func_log:
                log += f" ({self._func_log})"
    
            LOGGER.info(log)
    
        last_exp = None
        elapsed_time = None
        while timeout_watch.remaining_time() > 0:
            try:
                elapsed_time = self.wait_timeout - timeout_watch.remaining_time()
                yield self.func(*self.func_args, **self.func_kwargs)
                time.sleep(self.sleep)
                elapsed_time = None
    
            except Exception as exp:
                last_exp = exp
                elapsed_time = self.wait_timeout - timeout_watch.remaining_time()
    
                if not self._should_ignore_exception(exp=last_exp):
>                   raise TimeoutExpiredError(
                        self._get_exception_log(exp=last_exp), last_exp=last_exp, elapsed_time=elapsed_time
                    )
E                   timeout_sampler.TimeoutExpiredError: Timed Out: 30
E                   Function: kubernetes.client.api_client.request  Kwargs: {'url': 'https://api.c01-mv-421.rhos-psi.cnv-qe.rhood.us:6443/apis/subresources.kubevirt.io/v1/namespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop', 'method': 'PUT', 'headers': {'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9b-f8PI', 'Content-Type': 'application/json'}}
E                   Last exception: ApiException: (409)
E                   Reason: Conflict
E                   HTTP response headers: HTTPHeaderDict({'Audit-Id': 'a908927a-e8fc-4e38-b1cb-d87ccb78bbbb', 'Cache-Control': 'no-cache, private', 'Content-Length': '390', 'Content-Type': 'application/json', 'Date': 'Tue, 10 Feb 2026 11:53:47 GMT', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Kubernetes-Pf-Flowschema-Uid': 'cc44f062-8f4c-4bd6-ae9c-c57c3a743560', 'X-Kubernetes-Pf-Prioritylevel-Uid': 'e328d015-75e1-4f90-8939-9355d8687b43'})
E                   HTTP response body: {
E                    "kind": "Status",
E                    "apiVersion": "v1",
E                    "metadata": {},
E                    "status": "Failure",
E                    "message": "Operation cannot be fulfilled on virtualmachine.kubevirt.io \"vm-stopped-for-reset-test-1770724427-2696245\": VM is not running",
E                    "reason": "Confiict",
E                    "details": {
E                     "name": "vm-stopped-for-reset-test-1770724427-2696245",
E                     "group": "kubevirt.io",
E                     "kind": "virtualmachine"
E                    },
E                    "code": 409
E                   }
E                   .
E                   Elapsed time: 0.036036014556884766 [0:00:00.036036]

.venv/lib/python3.14/site-packages/timeout_sampler/__init__.py:171: TimeoutExpiredError

The above exception was the direct cause of the following exception:

unprivileged_client = <kubernetes.dynamic.client.DynamicClient object at 0x7facdf702520>, namespace = <ocp_resources.namespace.Namespace object at 0x7facde27eb10>

    @pytest.fixture(scope="class")
    def stopped_fedora_vm(unprivileged_client, namespace):
        """
        Stopped Fedora VirtualMachine for negative testing.
    
        Yields:
            VirtualMachine: Stopped VM
        """
        name = "vm-stopped-for-reset-test"
        with VirtualMachineForTests(
            client=unprivileged_client,
            name=name,
            namespace=namespace.name,
            body=fedora_vm_body(name=name),
        ) as vm:
>           vm.stop(wait=True)

tests/virt/node/general/test_vmi_reset_comprehensive.py:90: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.14/site-packages/ocp_resources/virtual_machine.py:105: in stop
    self.api_request(method="PUT", action="stop")
.venv/lib/python3.14/site-packages/ocp_resources/virtual_machine.py:79: in api_request
    return super().api_request(
.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1337: in api_request
    response = self.retry_cluster_exceptions(
.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1152: in retry_cluster_exceptions
    raise exp.last_exp from exp
.venv/lib/python3.14/site-packages/timeout_sampler/__init__.py:162: in __iter__
    yield self.func(*self.func_args, **self.func_kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.14/site-packages/kubernetes/client/api_client.py:399: in request
    return self.rest_client.PUT(url,
.venv/lib/python3.14/site-packages/kubernetes/client/rest.py:289: in PUT
    return self.request("PUT", url,
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <kubernetes.client.rest.RESTClientObject object at 0x7facdf702b10>, method = 'PUT'
url = 'https://api.c01-mv-421.rhos-psi.cnv-qe.rhood.us:6443/apis/subresources.kubevirt.io/v1/namespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop'
query_params = None, headers = {'Content-Type': 'application/json', 'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9b-f8PI'}, body = None, post_params = {}
_preload_content = True, _request_timeout = None

    def request(self, method, url, query_params=None, headers=None,
                body=None, post_params=None, _preload_content=True,
                _request_timeout=None):
        """Perform requests.
    
        :param method: http request method
        :param url: http request url
        :param query_params: query parameters in the url
        :param headers: http request headers
        :param body: request json body, for `application/json`
        :param post_params: request post parameters,
                            `application/x-www-form-urlencoded`
                            and `multipart/form-data`
        :param _preload_content: if False, the urllib3.HTTPResponse object will
                                 be returned without reading/decoding response
                                 data. Default is True.
        :param _request_timeout: timeout setting for this request. If one
                                 number provided, it will be total request
                                 timeout. It can also be a pair (tuple) of
                                 (connection, read) timeouts.
        """
        method = method.upper()
        assert method in ['GET', 'HEAD', 'DELETE', 'POST', 'PUT',
                          'PATCH', 'OPTIONS']
    
        if post_params and body:
            raise ApiValueError(
                "body parameter cannot be used with post_params parameter."
            )
    
        post_params = post_params or {}
        headers = headers or {}
    
        timeout = None
        if _request_timeout:
            if isinstance(_request_timeout, (int, ) if six.PY3 else (int, long)):  # noqa: E501,F821
                timeout = urllib3.Timeout(total=_request_timeout)
            elif (isinstance(_request_timeout, tuple) and
                  len(_request_timeout) == 2):
                timeout = urllib3.Timeout(
                    connect=_request_timeout[0], read=_request_timeout[1])
    
        if 'Content-Type' not in headers:
            headers['Content-Type'] = 'application/json'
    
        try:
            # For `POST`, `PUT`, `PATCH`, `OPTIONS`, `DELETE`
            if method in ['POST', 'PUT', 'PATCH', 'OPTIONS', 'DELETE']:
                if query_params:
                    url += '?' + urlencode(query_params)
                if (re.search('json', headers['Content-Type'], re.IGNORECASE) or
                        headers['Content-Type'] == 'application/apply-patch+yaml'):
                    if headers['Content-Type'] == 'application/json-patch+json':
                        if not isinstance(body, list):
                            headers['Content-Type'] = \
                                'application/strategic-merge-patch+json'
                    request_body = None
                    if body is not None:
                        request_body = json.dumps(body)
                    r = self.pool_manager.request(
                        method, url,
                        body=request_body,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                elif headers['Content-Type'] == 'application/x-www-form-urlencoded':  # noqa: E501
                    r = self.pool_manager.request(
                        method, url,
                        fields=post_params,
                        encode_multipart=False,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                elif headers['Content-Type'] == 'multipart/form-data':
                    # must del headers['Content-Type'], or the correct
                    # Content-Type which generated by urllib3 will be
                    # overwritten.
                    del headers['Content-Type']
                    r = self.pool_manager.request(
                        method, url,
                        fields=post_params,
                        encode_multipart=True,
                         preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                # Pass a `string` parameter directly in the body to support
                # other content types than Json when `body` argument is
                # provided in serialized form
                elif isinstance(body, str) or isinstance(body, bytes):
                    request_body = body
                    r = self.pool_manager.request(
                        method, url,
                        body=request_body,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                else:
                    # Cannot generate the request from given parameters
                    msg = """Cannot prepare a request message for provided
                             arguments. Please check that your arguments match
                             declared content type."""
                   raise ApiException(status=0, reason=msg)
            # For `GET`, `HEAD`
            else:
                r = self.pool_manager.request(method, url,
                                              fields=query_params,
                                              preload_content=_preload_content,
                                              timeout=timeout,
                                              headers=headers)
        except urllib3.exceptions.SSLError as e:
            msg = "{0}\n{1}".format(type(e).__name__, str(e))
            raise ApiException(status=0, reason=msg)
    
        if _preload_content:
            r = RESTResponse(r)
    
            # In the python 3, the response.data is bytes.
            # we need to decode it to string.
            if six.PY3:
                r.data = r.data.decode('utf8')
    
            # log response body
            logger.debug("response body: %s", r.data)
    
        if not 200 <= r.status <= 299:
>           raise ApiException(http_resp=r)
E           kubernetes.client.exceptions.ApiException: (409)
E           Reason: Conflict
E           HTTP response headers: HTTPHeaderDict({'Audit-Id': 'a908927a-e8fc-4e38-b1cb-d87ccb78bbbb', 'Cache-Control': 'no-cache, private', 'Content-Length': '390', 'Content-Type': 'application/json', 'Date': 'Tue, 10 Feb 2026 11:53:47 GMT', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Kubernetes-Pf-Flowschema-Uid': 'cc44f062-8f4c-4bd6-ae9c-c57c3a743560', 'X-Kubernetes-Pf-Prioritylevel-Uid': 'e328d015-75e1-4f90-8939-9355d8687b43'})
E           HTTP response body: {
E            "kind": "Status",
E            "apiVersion": "v1",
E            "metadata": {},
E            "status": "Failure",
E            "message": "Operation cannot be fulfilled on virtualmachine.kubevirt.io \"vm-stopped-for-reset-test-1770724427-2696245\": VM is not running",
E            "reason": "Conflict",
E            "details": {
E             "name": "vm-stopped-for-reset-test-1770724427-2696245",
E             "group": "kubevirt.io",
E             "kind": "virtualmachine"
E            },
E            "code": 409
E           }

.venv/lib/python3.14/site-packages/kubernetes/client/rest.py:238: ApiException
func = <bound method ApiClient.request of <kubernetes.client.api_client.ApiClient object at 0x7facdf701940>>
exceptions_dict = {<class 'urllib3.exceptions.MaxRetryError'>: [], <class 'ConnectionAbortedError'>: [], <class 'ConnectionResetError'>:...eader changed', 'etcdserver: request timed out', 'Internal error occurred: failed calling webhook', 'rpc error:'], ...}
timeout = 30, sleep_time = 5
kwargs = {'headers': {'Content-Type': 'application/json', 'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9...amespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop'}
sampler = <timeout_sampler.TimeoutSampler object at 0x7faccc72bf70>

    @staticmethod
    def retry_cluster_exceptions(
        func: Callable,
        exceptions_dict: dict[type[Exception], list[str]] = DEFAULT_CLUSTER_RETRY_EXCEPTIONS,
        timeout: int = TIMEOUT_10SEC,
        sleep_time: int = 1,
        **kwargs: Any,
    ) -> Any:
        try:
            sampler = TimeoutSampler(
                wait_timeout=timeout,
                sleep=sleep_time,
                func=func,
                print_log=False,
                exceptions_dict=exceptions_dict,
                **kwargs,
            )
>           for sample in sampler:
                          ^^^^^^^

.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1147: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <timeout_sampler.TimeoutSampler object at 0x7faccc72bf70>

    def __iter__(self) -> Any:
        """
        Call `func` and yield the result, or raise an exception on timeout.
    
        Yields:
            any: Return value from `func`
    
        Raises:
            TimeoutExpiredError: if `func` takes longer than `wait_timeout` seconds to return a value
        """
        timeout_watch = TimeoutWatch(timeout=self.wait_timeout)
        if self.print_log:
            log = (
                f"Waiting for {self.wait_timeout} seconds"
                f" [{datetime.timedelta(seconds=self.wait_timeout)}], retry every"
                f" {self.sleep} seconds."
            )
    
            if self.print_func_log:
                log += f" ({self._func_log})"
    
            LOGGER.info(log)
    
        last_exp = None
        elapsed_time = None
        while timeout_watch.remaining_time() > 0:
            try:
                elapsed_time = self.wait_timeout - timeout_watch.remaining_time()
                yield self.func(*self.func_args, **self.func_kwargs)
                time.sleep(self.sleep)
                elapsed_time = None
    
            except Exception as exp:
                last_exp = exp
                elapsed_time = self.wait_timeout - timeout_watch.remaining_time()
    
                if not self._should_ignore_exception(exp=last_exp):
>                   raise TimeoutExpiredError(
                        self._get_exception_log(exp=last_exp), last_exp=last_exp, elapsed_time=elapsed_time
                    )
E                   timeout_sampler.TimeoutExpiredError: Timed Out: 30
E                   Function: kubernetes.client.api_client.request  Kwargs: {'url': 'https://api.c01-mv-421.rhos-psi.cnv-qe.rhood.us:6443/apis/subresources.kubevirt.io/v1/namespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop', 'method': 'PUT', 'headers': {'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9b-f8PI', 'Content-Type': 'application/json'}}
E                   Last exception: ApiException: (409)
E                   Reason: Conflict
E                   HTTP response headers: HTTPHeaderDict({'Audit-Id': 'a908927a-e8fc-4e38-b1cb-d87ccb78bbbb', 'Cache-Control': 'no-cache, private', 'Content-Length': '390', 'Content-Type': 'application/json', 'Date': 'Tue, 10 Feb 2026 11:53:47 GMT', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Kubernetes-Pf-Flowschema-Uid': 'cc44f062-8f4c-4bd6-ae9c-c57c3a743560', 'X-Kubernetes-Pf-Prioritylevel-Uid': 'e328d015-75e1-4f90-8939-9355d8687b43'})
E                   HTTP response body: {
E                    "kind": "Status",
E                    "apiVersion": "v1",
E                    "metadata": {},
E                    "status": "Failure",
E                    "message": "Operation cannot be fulfilled on virtualmachine.kubevirt.io \"vm-stopped-for-reset-test-1770724427-2696245\": VM is not running",
E                    "reason": "Conflict",
E                    "details": {
E                     "name": "vm-stopped-for-reset-test-1770724427-2696245",
E                     "group": "kubevirt.io",
E                     "kind": "virtualmachine"
E                    },
E                    "code": 409
E                   }
E                   .
E                   Elapsed time: 0.036036014556884766 [0:00:00.036036]

.venv/lib/python3.14/site-packages/timeout_sampler/__init__.py:171: TimeoutExpiredError

The above exception was the direct cause of the following exception:

unprivileged_client = <kubernetes.dynamic.client.DynamicClient object at 0x7facdf702520>, namespace = <ocp_resources.namespace.Namespace object at 0x7facde27eb10>

    @pytest.fixture(scope="class")
    def stopped_fedora_vm(unprivileged_client, namespace):
        """
        Stopped Fedora VirtualMachine for negative testing.
    
        Yields:
            VirtualMachine: Stopped VM
        """
        name = "vm-stopped-for-reset-test"
        with VirtualMachineForTests(
            client=unprivileged_client,
            name=name,
            namespace=namespace.name,
            body=fedora_vm_body(name=name),
        ) as vm:
>           vm.stop(wait=True)

tests/virt/node/general/test_vmi_reset_comprehensive.py:90: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.14/site-packages/ocp_resources/virtual_machine.py:105: in stop
    self.api_request(method="PUT", action="stop")
.venv/lib/python3.14/site-packages/ocp_resources/virtual_machine.py:79: in api_request
    return super().api_request(
.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1337: in api_request
    response = self.retry_cluster_exceptions(
.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1152: in retry_cluster_exceptions
    raise exp.last_exp from exp
.venv/lib/python3.14/site-packages/timeout_sampler/__init__.py:162: in __iter__
    yield self.func(*self.func_args, **self.func_kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.14/site-packages/kubernetes/client/api_client.py:399: in request
    return self.rest_client.PUT(url,
.venv/lib/python3.14/site-packages/kubernetes/client/rest.py:289: in PUT
    return self.request("PUT", url,
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <kubernetes.client.rest.RESTClientObject object at 0x7facdf702b10>, method = 'PUT'
url = 'https://api.c01-mv-421.rhos-psi.cnv-qe.rhood.us:6443/apis/subresources.kubevirt.io/v1/namespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop'
query_params = None, headers = {'Content-Type': 'application/json', 'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9b-f8PI'}, body = None, post_params = {}
_preload_content = True, _request_timeout = None

    def request(self, method, url, query_params=None, headers=None,
                body=None, post_params=None, _preload_content=True,
                _request_timeout=None):
        """Perform requests.
    
        :param method: http request method
        :param url: http request url
        :param query_params: query parameters in the url
        :param headers: http request headers
        :param body: request json body, for `application/json`
        :param post_params: request post parameters,
                            `application/x-www-form-urlencoded`
                            and `multipart/form-data`
        :param _preload_content: if False, the urllib3.HTTPResponse object will
                                 be returned without reading/decoding response
                                 data. Default is True.
        :param _request_timeout: timeout setting for this request. If one
                                 number provided, it will be total request
                                 timeout. It can also be a pair (tuple) of
                                 (connection, read) timeouts.
        """
        method = method.upper()
        assert method in ['GET', 'HEAD', 'DELETE', 'POST', 'PUT',
                          'PATCH', 'OPTIONS']
    
        if post_params and body:
            raise ApiValueError(
                "body parameter cannot be used with post_params parameter."
            )
    
        post_params = post_params or {}
        headers = headers or {}
    
        timeout = None
        if _request_timeout:
            if isinstance(_request_timeout, (int, ) if six.PY3 else (int, long)):  # noqa: E501,F821
                timeout = urllib3.Timeout(total=_request_timeout)
            elif (isinstance(_request_timeout, tuple) and
                  len(_request_timeout) == 2):
                timeout = urllib3.Timeout(
                    connect=_request_timeout[0], read=_request_timeout[1])
    
        if 'Content-Type' not in headers:
            headers['Content-Type'] = 'application/json'
    
        try:
            # For `POST`, `PUT`, `PATCH`, `OPTIONS`, `DELETE`
            if method in ['POST', 'PUT', 'PATCH', 'OPTIONS', 'DELETE']:
                if query_params:
                    url += '?' + urlencode(query_params)
                if (re.search('json', headers['Content-Type'], re.IGNORECASE) or
                        headers['Content-Type'] == 'application/apply-patch+yaml'):
                    if headers['Content-Type'] == 'application/json-patch+json':
                        if not isinstance(body, list):
                            headers['Content-Type'] = \
                                'application/strategic-merge-patch+json'
                    request_body = None
                    if body is not None:
                        request_body = json.dumps(body)
                    r = self.pool_manager.request(
                        method, url,
                        body=request_body,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                elif headers['Content-Type'] == 'application/x-www-form-urlencoded':  # noqa: E501
                    r = self.pool_manager.request(
                        method, url,
                        fields=post_params,
                        encode_multipart=False,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                elif headers['Content-Type'] == 'multipart/form-data':
                    # must del headers['Content-Type'], or the correct
                    # Content-Type which generated by urllib3 will be
                    # overwritten.
                    del headers['Content-Type']
                    r = self.pool_manager.request(
                        method, url,
                        fields=post_params,
                        encode_multipart=True,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                # Pass a `string` parameter directly in the body to support
                # other content types than Json when `body` argument is
                 # provided in serialized form
                elif isinstance(body, str) or isinstance(body, bytes):
                    request_body = body
                    r = self.pool_manager.request(
                        method, url,
                        body=request_body,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                else:
                    # Cannot generate the request from given parameters
                    msg = """Cannot prepare a request message for provided
                             arguments. Please check that your arguments match
                             declared content type."""
                    raise ApiException(status=0, reason=msg)
            # For `GET`, `HEAD`
            else:
                r = self.pool_manager.request(method, url,
                                              fields=query_params,
                                              preload_cotent=_preload_content,
                                              timeout=timeout,
                                              headers=headers)
        except urllib3.exceptions.SSLError as e:
            msg = "{0}\n{1}".format(type(e).__name__, str(e))
            raise ApiException(status=0, reason=msg)
    
        if _preload_content:
            r = RESTResponse(r)
    
            # In the python 3, the response.data is bytes.
            # we need to decode it to string.
            if six.PY3:
                r.data = r.data.decode('utf8')
    
            # log response body
            logger.debug("response body: %s", r.data)
    
        if not 200 <= r.status <= 299:
>           raise ApiException(http_resp=r)
E           kubernetes.client.exceptions.ApiException: (409)
E           Reason: Conflict
E           HTTP response headers: HTTPHeaderDict({'Audit-Id': 'a908927a-e8fc-4e38-b1cb-d87ccb78bbbb', 'Cache-Control': 'no-cache, private', 'Content-Length': '390', 'Content-Type': 'application/json', 'Date': 'Tue, 10 Feb 2026 11:53:47 GMT', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Kubernetes-Pf-Flowschema-Uid': 'cc44f062-8f4c-4bd6-ae9c-c57c3a743560', 'X-Kubernetes-Pf-Prioritylevel-Uid': 'e328d015-75e1-4f90-8939-9355d8687b43'})
E           HTTP response body: {
E            "kind": "Status",
E            "apiVersion": "v1",
E            "metadata": {},
E            "status": "Failure",
E            "message": "Operation cannot be fulfilled on virtualmachine.kubevirt.io \"vm-stopped-for-reset-test-1770724427-2696245\": VM is not running",
E            "reason": "Conflict",
E            "details": {
E             "name": "vm-stopped-for-reset-test-1770724427-2696245",
E             "group": "kubevirt.io",
E             "kind": "virtualmachine"
E            },
E            "code": 409
E           }

.venv/lib/python3.14/site-packages/kubernetes/client/rest.py:238: ApiException
------------------------------------------------------- TEARDOWN -------------------------------------------------------
______________________________________________________ 9 of 12 completed, 5 Pass, 2 Fail, 0 Skip, 0 XPass, 0 XFail, 2 Error, 0 ReRun _______________________________________________________

tests/virt/node/general/test_vmi_reset_comprehensive.py 
------------------------------------------- test_reset_nonexistent_vmi_fails -------------------------------------------
-------------------------------------------------------- SETUP --------------------------------------------------------
2026-02-10T11:53:48.768862 conftest INFO Executing function fixture: term_handler_scope_function
2026-02-10T11:53:48.769206 conftest INFO Executing function fixture: autouse_fixtures
E

_______________________________________________________ ERROR at setup of TestVMIResetErrorHandling.test_reset_nonexistent_vmi_fails _______________________________________________________

func = <bound method ApiClient.request of <kubernetes.client.api_client.ApiClient object at 0x7facdf701940>>
exceptions_dict = {<class 'urllib3.exceptions.MaxRetryError'>: [], <class 'ConnectionAbortedError'>: [], <class 'ConnectionResetError'>:...eader changed', 'etcdserver: request timed out', 'Internal error occurred: failed calling webhook', 'rpc error:'], ...}
timeout = 30, sleep_time = 5
kwargs = {'headers': {'Content-Type': 'application/json', 'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9...amespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop'}
sampler = <timeout_sampler.TimeoutSampler object at 0x7faccc72bf70>

    @staticmethod

TEST: TestVMIResetErrorHandling.test_reset_nonexistent_vmi_fails [setup] STATUS: ERROR
    def retry_cluster_exceptions(
        func: Callable,
        exceptions_dict: dict[type[Exception], list[str]] = DEFAULT_CLUSTER_RETRY_EXCEPTIONS,
        timeout: int = TIMEOUT_10SEC,
        sleep_time: int = 1,
        **kwargs: Any,
    ) -> Any:
        try:
            sampler = TimeoutSampler(
                wait_timeout=timeout,
                sleep=sleep_time,
                func=func,
                print_log=False,
                exceptions_dict=exceptions_dict,
                **kwargs,
            )
>           for sample in sampler:
                          ^^^^^^^

.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1147: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <timeout_sampler.TimeoutSampler object at 0x7faccc72bf70>

    def __iter__(self) -> Any:
        """
        Call `func` and yield the result, or raise an exception on timeout.
    
        Yields:
            any: Return value from `func`
    
        Raises:
            TimeoutExpiredError: if `func` takes longer than `wait_timeout` seconds to return a value
        """
        timeout_watch = TimeoutWatch(timeout=self.wait_timeout)
        if self.print_log:
            log = (
                f"Waiting for {self.wait_timeout} seconds"
                f" [{datetime.timedelta(seconds=self.wait_timeout)}], retry every"
                f" {self.sleep} seconds."
            )
    
            if self.print_func_log:
                log += f" ({self._func_log})"
    
            LOGGER.info(log)
    
        last_exp = None
        elapsed_time = None
        while timeout_watch.remaining_time() > 0:
            try:
                elapsed_time = self.wait_timeout - timeout_watch.remaining_time()
                yield self.func(*self.func_args, **self.func_kwargs)
                time.sleep(self.sleep)
                elapsed_time = None
    
            except Exception as exp:
                last_exp = exp
                elapsed_time = self.wait_timeout - timeout_watch.remaining_time()
    
                if not self._should_ignore_exception(exp=last_exp):
>                   raise TimeoutExpiredError(
                        self._get_exception_log(exp=last_exp), last_exp=last_exp, elapsed_time=elapsed_time
                    )
E                   timeout_sampler.TimeoutExpiredError: Timed Out: 30
E                   Function: kubernetes.client.api_client.request  Kwargs: {'url': 'https://api.c01-mv-421.rhos-psi.cnv-qe.rhood.us:6443/apis/subresources.kubevirt.io/v1/namespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop', 'method': 'PUT', 'headers': {'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9b-f8PI', 'Content-Type': 'application/json'}}
E                   Last exception: ApiException: (409)
E                   Reason: Conflict
E                   HTTP response headers: HTTPHeaderDict({'Audit-Id': 'a908927a-e8fc-4e38-b1cb-d87ccb78bbbb', 'Cache-Control': 'no-cache, private', 'Content-Length': '390', 'Content-Type': 'application/json', 'Date': 'Tue, 10 Feb 2026 11:53:47 GMT', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Kubernetes-Pf-Flowschema-Uid': 'cc44f062-8f4c-bbd6-ae9c-c57c3a743560', 'X-Kubernetes-Pf-Prioritylevel-Uid': 'e328d015-75e1-4f90-8939-9355d8687b43'})
E                   HTTP response body: {
E                    "kind": "Status",
E                    "apiVersion": "v1",
E                    "metadata": {},
E                    "status": "Failure",
E                    "message": "Operation cannot be fulfilled on virtualmachine.kubevirt.io \"vm-stopped-for-reset-test-1770724427-2696245\": VM is not running",
E                    "reason": "Conflict",
E                    "details": {
E                     "name": "vm-stopped-for-reset-test-1770724427-2696245",
E                     "group": "kubevirt.io",
E                     "kind": "virtualmachine"
E                    },
E                    "code": 409
E                   }
E                   .
E                   Elapsed time: 0.036036014556884766 [0:00:00.036036]

.venv/lib/python3.14/site-packages/timeout_sampler/__init__.py:171: TimeoutExpiredError

The above exception was the direct cause of the following exception:

unprivileged_client = <kubernetes.dynamic.client.DynamicClient object at 0x7facdf702520>, namespace = <ocp_resources.namespace.Namespace object at 0x7facde27eb10>

    @pytest.fixture(scope="class")
    def stopped_fedora_vm(unprivileged_client, namespace):
        """
        Stopped Fedora VirtualMachine for negative testing.
    
        Yields:
            VirtualMachine: Stopped VM
        """
        name = "vm-stopped-for-reset-test"
        with VirtualMachineForTests(
            client=unprivileged_client,
            name=name,
            namespace=namespace.name,
            body=fedora_vm_body(name=name),
        ) as vm:
>           vm.stop(wait=True)

tests/virt/node/general/test_vmi_reset_comprehensive.py:90: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.14/site-packages/ocp_resources/virtual_machine.py:105: in stop
    self.api_request(method="PUT", action="stop")
.venv/lib/python3.14/site-packages/ocp_resources/virtual_machine.py:79: in api_request
    return super().api_request(
.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1337: in api_request
    response = self.retry_cluster_exceptions(
.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1152: in retry_cluster_exceptions
    raise exp.last_exp from exp
.venv/lib/python3.14/site-packages/timeout_sampler/__init__.py:162: in __iter__
    yield self.func(*self.func_args, **self.func_kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.14/site-packages/kubernetes/client/api_client.py:399: in request
    return self.rest_client.PUT(url,
.venv/lib/python3.14/site-packages/kubernetes/client/rest.py:289: in PUT
    return self.request("PUT", url,
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <kubernetes.client.rest.RESTClientObject object at 0x7facdf702b10>, method = 'PUT'
url = 'https://api.c01-mv-421.rhos-psi.cnv-qe.rhood.us:6443/apis/subresources.kubevirt.io/v1/namespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop'
query_params = None, headers = {'Content-Type': 'application/json', 'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9b-f8PI'}, body = None, post_params = {}
_preload_content = True, _request_timeout = None

    def request(self, method, url, query_params=None, headers=None,
                body=None, post_params=None, _preload_content=True,
                _request_timeout=None):
        """Perform requests.
    
        :param method: http request method
        :param url: http request url
        :param query_params: query parameters in the url
        :param headers: http request headers
        :param body: request json body, for `application/json`
        :param post_params: request post parameters,
                            `application/x-www-form-urlencoded`
                            and `multipart/form-data`
        :param _preload_content: if False, the urllib3.HTTPResponse object will
                                 be returned without reading/decoding response
                                 data. Default is True.
        :param _request_timeout: timeout setting for this request. If one
                                 number provided, it will be total request
                                 timeout. It can also be a pair (tuple) of
                                 (connection, read) timeouts.
        """
        method = method.upper()
        assert method in ['GET', 'HEAD', 'DELETE', 'POST', 'PUT',
                          'PATCH', 'OPTIONS']
    
        if post_params and body:
            raise ApiValueError(
                "body parameter cannot be used with post_params parameter."
            )
    
        post_params = post_params or {}
        headers = headers or {}
    
        timeout = None
        if _request_timeout:
            if isinstance(_request_timeout, (int, ) if six.PY3 else (int, long)):  # noqa: E501,F821
                timeout = urllib3.Timeout(total=_request_timeout)
            elif (isinstance(_request_timeout, tuple) and
                  len(_request_timeout) == 2):
                timeout = urllib3.Timeout(
                    connect=_request_timeout[0], read=_request_timeout[1])
    
        if 'Content-Type' not in headers:
            headers['Content-Type'] = 'application/json'
    
        try:
            # For `POST`, `PUT`, `PATCH`, `OPTIONS`, `DELETE`
            if method in ['POST', 'PUT', 'PATCH', 'OPTIONS', 'DELETE']:
                if query_params:
                    url += '?' + urlencode(query_params)
                if (re.search('json', headers['Content-Type'], re.IGNORECASE) or
                        headers['Content-Type'] == 'application/apply-patch+yaml'):
                    if headers['Content-Type'] == 'application/json-patch+json':
                        if not isinstance(body, list):
                            headers['Content-Type'] = \
                                'application/strategic-merge-patch+json'
                    request_body = None
                    if body is not None:
                        request_body = json.dumps(body)
                    r = self.pool_manager.request(
                        method, url,
                        body=request_body,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                elif headers['Content-Type'] == 'application/x-www-form-urlencoded':  # noqa: E501
                    r = self.pool_manager.request(
                        method, url,
                        fields=post_params,
                        encode_multipart=False,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                elif headers['Content-Type'] == 'multipart/form-data':
                    # must del headers['Content-Type'], or the correct
                    # Content-Type which generated by urllib3 will be
                    # overwritten.
                    del headers['Content-Type']
                    r = self.pool_manager.request(
                        method, url,
                        fields=post_params,
                        encode_multipart=True,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                # Pass a `string` parameter directly in the body to support
                # other content types than Json when `body` argument is
                # provided in serialized form
                elif isinstance(body, str) or isinstance(body, bytes):
                    request_body = body
                    r = self.pool_manager.request(
                        methd, url,
                        body=request_body,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                else:
                    # Cannot generate the request from given parameters
                    msg = """Cannot prepare a request message for provided
                             arguments. Please check that your arguments match
                             declared content type."""
                    raise ApiException(status=0, reason=msg)
            # For `GET`, `HEAD`
            else:
                r = self.pool_manager.request(method, url,
                                              fields=query_params,
                                              preload_content=_preload_content,
                                              timeout=timeout,
                                              headers=headers)
        except urllib3.exceptions.SSLError as e:
            msg = "{0}\n{1}".format(type(e).__name__, str(e))
            raise ApiException(status=0, reason=msg)
    
        if _preload_content:
            r = RESTResponse(r)
    
            # In the python 3, the response.data is bytes.
            # we need to decode it to string.
            if six.PY3:
                r.data = r.data.decode('utf8')
    
            # log response body
            logger.debug("response body: %s", r.data)
    
        if not 200 <= r.status <= 299:
>           raise ApiException(http_resp=r)
E           kubernetes.client.exceptions.ApiException: (409)
E           Reason: Conflict
E           HTTP response headers: HTTPHeaderDict({'Audit-Id': 'a908927a-e8fc-4e38-b1cb-d87ccb78bbbb', 'Cache-Control': 'no-cache, private', 'Content-Length': '390', 'Content-Type': 'application/json', 'Date': 'Tue, 10 Feb 2026 11:53:47 GMT', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Kubernetes-Pf-Flowschema-Uid': 'cc44f062-8f4c-4bd6-ae9c-c57c3a743560', 'X-Kubernetes-Pf-Prioritylevel-Uid': 'e328d015-75e1-4f90-8939-9355d8687b43'})
E           HTTP response body: {
E            "kind": "Status",
E            "apiVersion": "v1",
E            "metadata": {},
E            "status": "Failure",
E            "message": "Operation cannot be fulfilled on virtualmachine.kubevirt.io \"vm-stopped-for-reset-test-1770724427-2696245\": VM is not running",
E            "reason": "Conflict",
E            "details": {
E             "name": "vm-stopped-for-reset-test-1770724427-2696245",
E             "group": "kubevirt.io",
E             "kind": "virtualmachine"
E            },
E            "code": 409
E           }

.venv/lib/python3.14/site-packages/kubernetes/client/rest.py:238: ApiException
func = <bound method ApiClient.request of <kubernetes.client.api_client.ApiClient object at 0x7facdf701940>>
exceptions_dict = {<class 'urllib3.exceptions.MaxRetryError'>: [], <class 'ConnectionAbortedError'>: [], <class 'ConnectionResetError'>:...eader changed', 'etcdserver: request timed out', 'Internal error occurred: failed calling webhook', 'rpc error:'], ...}
timeout = 30, sleep_time = 5
kwargs = {'headers': {'Content-Type': 'application/json', 'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9...amespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop'}
sampler = <timeout_sampler.TimeoutSampler object at 0x7faccc72bf70>

    @staticmethod
    def retry_cluster_exceptions(
        func: Callable,
        exceptions_dict: dict[type[Exception], list[str]] = DEFAULT_CLUSTER_RETRY_EXCEPTIONS,
        timeout: int = TIMEOUT_10SEC,
        sleep_time: int = 1,
        **kwargs: Any,
    ) -> Any:
        try:
            sampler = TimeoutSampler(
                wait_timeout=timeout,
                sleep=sleep_time,
                func=func,
                print_log=False,
                exceptions_dict=exceptions_dict,
                **kwargs,
            )
>           for sample in sampler:
                          ^^^^^^^

.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1147: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <timeout_sampler.TimeoutSampler object at 0x7faccc72bf70>

    def __iter__(self) -> Any:
        """
        Call `func` and yield the result, or raise an exception on timeout.
    
        Yields:
            any: Return value from `func`
    
        Raises:
            TimeoutExpiredError: if `func` takes longer than `wait_timeout` seconds to return a value
        """
        timeout_watch = TimeoutWatch(timeout=self.wait_timeout)
        if self.print_log:
            log = (
                f"Waiting for {self.wait_timeout} seconds"
                f" [{datetime.timedelta(seconds=self.wait_timeout)}], retry every"
                f" {self.sleep} seconds."
            )
    
            if self.print_func_log:
                log += f" ({self._func_log})"
    
            LOGGER.info(log)
    
        last_exp = None
        elapsed_time = None
        while timeout_watch.remaining_time() > 0:
            try:
                elapsed_time = self.wait_timeout - timeout_watch.remaining_time()
                yield self.func(*self.func_args, **self.func_kwargs)
                time.sleep(self.sleep)
                elapsed_time = None
    
            except Exception as exp:
                last_exp = exp
                elapsed_time = self.wait_timeout - timeout_watch.remaining_time()
    
                if not self._should_ignore_exception(exp=last_exp):
>                   raise TimeoutExpiredError(
                        self._get_exception_log(exp=last_exp), last_exp=last_exp, elapsed_time=elapsed_time
                    )
E                   timeout_sampler.TimeoutExpiredError: Timed Out: 30
E                   Function: kubernetes.client.api_client.request  Kwargs: {'url': 'https://api.c01-mv-421.rhos-psi.cnv-qe.rhood.us:6443/apis/subresources.kubevirt.io/v1/namespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop', 'method': 'PUT', 'headers': {'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9b-f8PI', 'Content-Type': 'application/json'}}
E                   Last exception: ApiException: (409)
E                   Reason: Conflict
E                   HTTP response headers: HTTPHeaderDict({'Audit-Id': 'a908927a-e8fc-4e38-b1cb-d87ccb78bbbb', 'Cache-Control': 'no-cache, private', 'Content-Length': '390', 'Content-Type': 'application/json', 'Date': 'Tue, 10 Feb 2026 11:53:47 GMT', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Kubernetes-Pf-Flowschema-Uid': 'cc44f062-8f4c-4bd6-ae9c-c57c3a743560', 'X-Kubernetes-Pf-Prioritylevel-Uid': 'e328d015-75e1-4f90-8939-9355d8687b43'})
E                   HTTP response body: {
E                    "kind": "Status",
E                    "apiVersion": "v1",
E                    "metadata": {},
E                    "staatus": "Failure",
E                    "message": "Operation cannot be fulfilled on virtualmachine.kubevirt.io \"vm-stopped-for-reset-test-1770724427-2696245\": VM is not running",
E                    "reason": "Conflict",
E                    "details": {
E                     "name": "vm-stopped-for-reset-test-1770724427-2696245",
E                     "group": "kubevirt.io",
E                     "kind": "virtualmachine"
E                    },
E                    "code": 409
E                   }
E                   .
E                   Elapsed time: 0.036036014556884766 [0:00:00.036036]

.venv/lib/python3.14/site-packages/timeout_sampler/__init__.py:171: TimeoutExpiredError

The above exception was the direct cause of the following exception:

unprivileged_client = <kubernetes.dynamic.client.DynamicClient object at 0x7facdf702520>, namespace = <ocp_resources.namespace.Namespace object at 0x7facde27eb10>

    @pytest.fixture(scope="class")
    def stopped_fedora_vm(unprivileged_client, namespace):
        """
        Stopped Fedora VirtualMachine for negative testing.
    
        Yields:
            VirtualMachine: Stopped VM
        """
        name = "vm-stopped-for-reset-test"
        with VirtualMachineForTests(
            client=unprivileged_client,
            name=name,
            namespace=namespace.name,
            body=fedora_vm_body(name=name),
        ) as vm:
>           vm.stop(wait=True)

tests/virt/node/general/test_vmi_reset_comprehensive.py:90: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _  _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.14/site-packages/ocp_resources/virtual_machine.py:105: in stop
    self.api_request(method="PUT", action="stop")
.venv/lib/python3.14/site-packages/ocp_resources/virtual_machine.py:79: in api_request
    return super().api_request(
.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1337: in api_request
    response = self.retry_cluster_exceptions(
.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1152: in retry_cluster_exceptions
    raise exp.last_exp from exp
.venv/lib/python3.14/site-packages/timeout_sampler/__init__.py:162: in __iter__
    yield self.func(*self.func_args, **self.func_kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.14/site-packages/kubernetes/client/api_client.py:399: in request
    return self.rest_client.PUT(url,
.venv/lib/python3.14/site-packages/kubernetes/client/rest.py:289: in PUT
    return self.request("PUT", url,
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <kubernetes.client.rest.RESTClientObject object at 0x7facdf702b10>, method = 'PUT'
url = 'https://api.c01-mv-421.rhos-psi.cnv-qe.rhood.us:6443/apis/subresources.kubevirt.io/v1/namespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop'
query_params = None, headers = {'Content-Type': 'application/json', 'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9b-f8PI'}, body = None, post_params = {}
_preload_content = True, _request_timeout = None

    def request(self, method, url, query_params=None, headers=None,
                body=None, post_params=None, _preload_content=True,
                _request_timeout=None):
        """Perform requests.
    
        :param method: http request method
        :param url: http request url
        :param query_params: query parameters in the url
        :param headers: http request headers
        :param body: request json body, for `application/json`
        :param post_params: request post parameters,
                            `application/x-www-form-urlencoded`
                            and `multipart/form-data`
        :param _preload_content: if False, the urllib3.HTTPResponse object will
                                 be returned without eading/decoding response
                                 data. Default is True.
        :param _request_timeout: timeout setting for this request. If one
                                 number provided, it will be total request
                                 timeout. It can also be a pair (tuple) of
                                 (connection, read) timeouts.
        """
        method = method.upper()
        assert method in ['GET', 'HEAD', 'DELETE', 'POST', 'PUT',
                          'PATCH', 'OPTIONS']
    
        if post_params and body:
            raise ApiValueError(
                "body parameter cannot be used with post_params parameter."
            )
    
        post_params = post_params or {}
        headers = headers or {}
    
        timeout = None
        if _request_timeout:
            if isinstance(_request_timeout, (int, ) if six.PY3 else (int, long)):  # noqa: E501,F821
                timeout = urllib3.Timeout(total=_request_timeout)
            elif (isinstance(_request_timeout, tuple) and
                  len(_request_timeout) == 2):
                timeout = urllib3.Timeout(
                    connect=_request_timeout[0], read=_request_timeout[1])
    
        if 'Content-Type' not in headers:
            headers['Content-Type'] = 'application/json'
    
        try:
            # For `POST`, `PUT`, `PATCH`, `OPTIONS`, `DELETE`
            if method in ['POST', 'PUT', 'PATCH', 'OPTIONS', 'DELETE']:
                if query_params:
                    url += '?' + urlencode(query_params)
                if (re.search('json', headers['Content-Type'], re.IGNORECASE) or
                        headers['Content-Type'] == 'application/apply-patch+yaml'):
                    if headers['Content-Type'] == 'application/json-patch+json':
                        if not isinstance(body, list):
                            headers['Content-Type'] = \
                                'application/strategic-merge-patch+json'
                    request_body = None
                    if body is not None:
                        request_body = json.dumps(body)
                    r = self.pool_manager.request(
                        method, url,
                        body=request_body,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                elif headers['Content-Type'] == 'application/x-www-form-urlencoded':  # noqa: E501
                    r = self.pool_manager.request(
                        method, url,
                        fields=post_params,
                        encode_multipart=False,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                elif headers['Content-Type'] == 'multipart/form-data':
                    # must del headers['Content-Type'], or the correct
                    # Content-Type which generated by urllib3 will be
                    # overwritten.
                    del headers['Content-Type']
                    r = self.pool_manager.request(
                        method, url,
                        fields=post_params,
                        encode_multipart=True,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                # Pass a `string` parameter directly in the body to support
                # other content types than Json when `body` argument is
                # provided in serialized form
                elif isinstance(body, str) or isinstance(body, bytes):
                    request_body = body
                    r = self.pool_manager.request(
                        method, url,
                        body=request_body,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                else:
                    # Cannot generate the request from given parameters
                    msg = """Cannot prepare a request message for provided
                             arguments. Please check that your arguments match
                             declared content type."""
                    raise ApiException(status=0, reason=msg)
            # For `GET`, `HEAD`
            else:
                r = self.pool_manager.request(method, url,
                                              fields=query_params,
                                              preload_content=_preload_content,
                                              timeout=timeout,
                                              headers=headers)
        except urllib3.exceptions.SSLError as e:
            msg = "{0}\n{1}".format(type(e).__name__, str(e))
            raiseApiException(status=0, reason=msg)
    
        if _preload_content:
            r = RESTResponse(r)
    
            # In the python 3, the response.data is bytes.
            # we need to decode it to string.
            if six.PY3:
                r.data = r.data.decode('utf8')
    
            # log response body
            logger.debug("response body: %s", r.data)
    
        if not 200 <= r.status <= 299:
>           raise ApiException(http_resp=r)
E           kubernetes.client.exceptions.ApiException: (409)
E           Reason: Conflict
E           HTTP response headers: HTTPHeaderDict({'Audit-Id': 'a908927a-e8fc-4e38-b1cb-d87ccb78bbbb', 'Cache-Control': 'no-cache, private', 'Content-Length': '390', 'Content-Type': 'application/json', 'Date': 'Tue, 10 Feb 2026 11:53:47 GMT', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Kubernetes-Pf-Flowschema-Uid': 'cc44f062-8f4c-4bd6-ae9c-c57c3a743560', 'X-Kubernetes-Pf-Prioritylevel-Uid': 'e328d015-75e1-4f90-8939-9355d8687b43'})
E           HTTP response body: {
E            "kind": "Status",
E            "apiVersion": "v1",
E            "metadata": {},
E            "status": "Failure",
E            "message": "Operation cannot be fulfilled on virtualmachine.kubevirt.io \"vm-stopped-for-reset-test-1770724427-2696245\": VM is not running",
E            "reason": "Conflict",
E            "details": {
E             "name": "vm-stopped-for-reset-test-1770724427-2696245",
E             "group": "kubevirt.io",
E             "kind": "virtualmachine"
E            },
E            "code": 409
E           }

.venv/lib/python3.14/site-packages/kubernetes/client/rest.py:238: ApiException
------------------------------------------------------- TEARDOWN -------------------------------------------------------
______________________________________________________ 10 of 12 completed, 5 Pass, 2 Fail, 0 Skip, 0 XPass, 0 XFail, 3 Error, 0 ReRun ______________________________________________________

tests/virt/node/general/test_vmi_reset_comprehensive.py .
______________________________________________________ 11 of 12 completed, 6 Pass, 2 Fail, 0 Skip, 0 XPass, 0 XFail, 3 Error, 0 ReRun ______________________________________________________

tests/deprecated_api/test_deprecation_audit_logs.py 
TEST: test_deprecated_apis_in_audit_logs STATUS: QUARANTINED
[NOTRUN] quarantined: Timeout after 180s retrieving logs Tracked <a href='https://issues.redhat.com/browse/CNV-76514' target='_blank'>CNV-76514</a>
______________________________________________________ 12 of 12 completed, 6 Pass, 2 Fail, 0 Skip, 0 XPass, 1 XFail, 3 Error, 0 ReRun ______________________________________________________
                                                                                                                                                                                     [100%]2026-02-10T11:56:55.664707 ocp_resources ConfigMap INFO Delete ConfigMap cnv-tests-run-in-progress
2026-02-10T11:56:55.678393 ocp_resources ConfigMap INFO Deleting {'kind': 'ConfigMap', 'apiVersion': 'v1', 'metadata': {'name': 'cnv-tests-run-in-progress', 'namespace': 'cnv-tests-run-in-progress-ns', 'uid': 'f64c14ad-cb90-4826-b601-1887c45562fb', 'resourceVersion': '6302289', 'creationTimestamp': '2026-02-10T11:45:48Z', 'managedFields': [{'manager': 'OpenAPI-Generator', 'operation': 'Update', 'apiVersion': 'v1', 'time': '2026-02-10T11:45:48Z', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:data': {'.': {}, 'f:host': {}, 'f:pytest_cmd': {}, 'f:run-in-container': {}, 'f:running_from_dir': {}, 'f:session-id': {}, 'f:user': {}}}}]}, 'data': '*******'}
2026-02-10T11:56:55.694353 ocp_resources ConfigMap INFO Wait until ConfigMap cnv-tests-run-in-progress is deleted
2026-02-10T11:56:55.707812 ocp_resources Namespace INFO Delete Namespace cnv-tests-run-in-progress-ns
2026-02-10T11:56:55.719133 ocp_resources Namespace INFO Deleting {'kind': 'Namespace', 'apiVersion': 'v1', 'metadata': {'name': 'cnv-tests-run-in-progress-ns', 'uid': '295d5971-799c-4116-b31b-0edc244c22c5', 'resourceVersion': '6302290', 'creationTimestamp': '2026-02-10T11:45:48Z', 'labels': {'kubernetes.io/metadata.name': 'cnv-tests-run-in-progress-ns', 'pod-security.kubernetes.io/audit': 'restricted', 'pod-security.kubernetes.io/audit-version': 'latest', 'pod-security.kubernetes.io/enforce': 'privileged', 'pod-security.kubernetes.io/warn': 'restricted', 'pod-security.kubernetes.io/warn-version': 'latest', 'security.openshift.io/scc.podSecurityLabelSync': 'false'}, 'annotations': {'openshift.io/sa.scc.mcs': 's0:c28,c27', 'openshift.io/sa.scc.supplemental-groups': '1000810000/10000', 'openshift.io/sa.scc.uid-range': '1000810000/10000', 'security.openshift.io/MinimallySufficientPodSecurityStandard': 'restricted'}, 'managedFields': [{'manager': 'cluster-policy-controller', 'operation': 'Apply', 'apiVersion': 'v1', 'time': '2026-02-10T11:45:48Z', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:metadata': {'f:annotations': {'f:openshift.io/sa.scc.mcs': {}, 'f:openshift.io/sa.scc.supplemental-groups': {}, 'f:openshift.io/sa.scc.uid-range': {}}}}}, {'manager': 'pod-security-admission-label-synchronization-controller', 'operation': 'Apply', 'apiVersion': 'v1', 'time': '2026-02-10T11:45:48Z', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:metadata': {'f:annotations': {'f:security.openshift.io/MinimallySufficientPodSecurityStandard': {}}, 'f:labels': {'f:pod-security.kubernetes.io/audit': {}, 'f:pod-security.kubernetes.io/audit-version': {}, 'f:pod-security.kubernetes.io/warn': {}, 'f:pod-security.kubernetes.io/warn-version': {}}}}}, {'manager': 'OpenAPI-Generator', 'operation': 'Update', 'apiVersion': 'v1', 'time': '2026-02-10T11:45:48Z', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:metadata': {'f:labels': {'.': {}, 'f:kubernetes.io/metadata.name': {}, 'f:pod-security.kubernetes.io/enforce': {}, 'f:security.openshift.io/scc.podSecurityLabelSync': {}}}}}]}, 'spec': {'finalizers': ['kubernetes']}, 'status': {'phase': 'Active'}}
2026-02-10T11:56:55.736236 ocp_resources Namespace INFO Wait until Namespace cnv-tests-run-in-progress-ns is deleted
====================================================== 2 failed, 6 passed, 32 warnings, 3 errors, 1 quarantined in 676.56s (0:11:16) =======================================================

========================================================================================== ERRRORS ==========================================================================================
_________________________________________________________ ERROR at setup of TestVMIResetErrorHandling.test_reset_stopped_vmi_fails _________________________________________________________

func = <bound method ApiClient.request of <kubernetes.client.api_client.ApiClient object at 0x7facdf701940>>
exceptions_dict = {<class 'urllib3.exceptions.MaxRetryError'>: [], <class 'ConnectionAbortedError'>: [], <class 'ConnectionResetError'>:...eader changed', 'etcdserver: request timed out', 'Internal error occurred: failed calling webhook', 'rpc error:'], ...}
timeout = 30, sleep_time = 5
kwargs = {'headers': {'Content-Type': 'application/json', 'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9...amespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop'}
sampler = <timeout_sampler.TimeoutSampler object at 0x7faccc72bf70>

    @staticmethod
    def retry_cluster_exceptions(
        func: Callable,
        exceptions_dict: dict[type[Exception], list[str]] = DEFAULT_CLUSTER_RETRY_EXCEPTIONS,
        timeout: int = TIMEOUT_10SEC,
        sleep_time: int = 1,
        **kwargs: Any,
    ) -> Any:
        try:
            sampler = TimeoutSampler(
                wait_timeout=timeout,
                sleep=sleep_time,
                func=func,
                print_log=False,
                exceptions_dict=exceptions_dict,
                **kwargs,
            )
>           for sample in sampler:
                          ^^^^^^^

.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1147: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <timeout_sampler.TimeoutSampler object at 0x7faccc72bf70>

    def __iter__(self) -> Any:
        """
        Call `func` and yield the result, or raise an exception on timeout.
    
        Yields:
            any: Return value from `func`
    
        Raises:
            TimeoutExpiredError: if `func` takes longer than `wait_timeout` seconds to return a value
        """
        timeout_watch = TimeoutWatch(timeout=self.wait_timeout)
        if self.print_log:
            log = (
                f"Waiting for {self.wait_timeout} seconds"
                f" [{datetime.timedelta(seconds=self.wait_timeout)}], retry every"
                f" {self.sleep} seconds."
            )
    
            if self.print_func_log:
                log += f" ({self._func_log})"
    
            LOGGER.info(log)
    
        last_exp = None
        elapsed_time = None
        while timeout_watch.remaining_time() > 0:
            try:
                elapsed_time = self.wait_timeout - timeout_watch.remaining_time()
                yield self.func(*self.func_args, **self.func_kwargs)
                time.sleep(self.sleep)
                elapsed_time = None
    
            except Exception as exp:
                last_exp = exp
                elapsed_time = self.wait_timeout - timeout_watch.remaining_time()
    
                if not self._should_ignore_exception(exp=last_exp):
>                   raise TimeoutExpiredError(
                        self._get_exception_log(exp=last_exp), last_exp=last_exp, elapsed_time=elapsed_time
                    )
E                   timeout_sampler.TimeoutExpiredError: Timed Out: 30
E                   Function: kubernetes.client.api_client.request  Kwargs: {'url': 'https://api.c01-mv-421.rhos-psi.cnv-qe.rhood.us:6443/apis/subresources.kubevirt.io/v1/namespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop', 'method': 'PUT', 'headers': {'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9b-f8PI', 'Content-Type': 'application/json'}}
E                   Last exception: ApiException: (409)
E                   Reason: Conflict
E                   HTTP response headers: HTTPHeadrDict({'Audit-Id': 'a908927a-e8fc-4e38-b1cb-d87ccb78bbbb', 'Cache-Control': 'no-cache, private', 'Content-Length': '390', 'Content-Type': 'application/json', 'Date': 'Tue, 10 Feb 2026 11:53:47 GMT', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Kubernetes-Pf-Flowschema-Uid': 'cc44f062-8f4c-4bd6-ae9c-c57c3a743560', 'X-Kubernetes-Pf-Prioritylevel-Uid': 'e328d015-75e1-4f90-8939-9355d8687b43'})
E                   HTTP response body: {
E                    "kind": "Status",
E                    "apiVersion": "v1",
E                    "metadata": {},
E                    "status": "Failure",
E                    "message": "Operation cannot be fulfilled on virtualmachine.kubevirt.io \"vm-stopped-for-reset-test-1770724427-2696245\": VM is not running",
E                    "reason": "Conflict",
E                    "details": {
E                     "name": "vm-stopped-for-reset-test-1770724427-2696245",
E                     "group": "kubevirt.io",
E                     "kind": "virtualmachine"
E                    },
E                    "code": 409
E                   }
E                   .
E                   Elapsed time: 0.036036014556884766 [0:00:00.036036]

.venv/lib/python3.14/site-packages/timeout_sampler/__init__.py:171: TimeoutExpiredError

The above exception was the direct cause of the following exception:

unprivileged_client = <kubernetes.dynamic.client.DynamicClient object at 0x7facdf702520>, namespace = <ocp_resources.namespace.Namespace object at 0x7facde27eb10>

    @pytest.fixture(scope="class")
    def stopped_fedora_vm(unprivileged_client, namespace):
        """
        Stopped Fedora VirtualMachine for negative testing.
    
        Yields:
            VirtualMachine: Stopped VM
        """
        name = "vm-stopped-for-reset-test"
        with VirtualMachineForTests(
            client=unprivileged_client,
            name=name,
            namespace=namespace.name,
            body=fedora_vm_body(name=name),
        ) as vm:
>           vm.stop(wait=True)

tests/virt/node/general/test_vmi_reset_comprehensive.py:90: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.14/site-packages/ocp_resources/virtual_machine.py:105: in stop
    self.api_request(method="PUT", action="stop")
.venv/lib/python3.14/site-packages/ocp_resources/virtual_machine.py:79: in api_request
    return super().api_request(
.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1337: in api_request
    response = self.retry_cluster_exceptions(
.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1152: in retry_cluster_exceptions
    raise exp.last_exp from exp
.venv/lib/python3.14/site-packages/timeout_sampler/__init__.py:162: in __iter__
    yield self.func(*self.func_args, **self.func_kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.14/site-packages/kubernetes/client/api_client.py:399: in rrequest
    return self.rest_client.PUT(url,
.venv/lib/python3.14/site-packages/kubernetes/client/rest.py:289: in PUT
    return self.request("PUT", url,
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <kubernetes.client.rest.RESTClientObject object at 0x7facdf702b10>, method = 'PUT'
url = 'https://api.c01-mv-421.rhos-psi.cnv-qe.rhood.us:6443/apis/subresources.kubevirt.io/v1/namespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop'
query_params = None, headers = {'Content-Type': 'application/json', 'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9b-f8PI'}, body = None, post_params = {}
_preload_content = True, _request_timeout = None

    def request(self, method, url, query_params=None, headers=None,
                body=None, post_params=None, _preload_content=True,
                _request_timeout=None):
        """Perform requests.
    
        :param method: http request method
        :param url: http request url
        :param query_params: query parameters in the url
        :param headers: http request headers
        :param body: request json body, for `application/json`
        :param post_params: request post parameters,
                            `application/x-www-form-urlencoded`
                            and `multipart/form-data`
        :param _preload_content: if False, the urllib3.HTTPResponse object will
                                 be returned without reading/decoding response
                                 data. Default is True.
        :param _request_timeout: timeout setting for this request. If one
                                 number provided, it will be total request
                                 timeout. It can also be a pair (tuple) of
                                 (connection, read) timeouts.
        """
        method = method.upper()
        assert method in ['GET', 'HEAD', 'DELETE', 'POST', 'PUT',
                          'PATCH', 'OPTIONS']
    
        if post_params and body:
            raise ApiValueError(
                "body parameter cannot be used with post_params parameter."
            )
    
        post_params = post_params or {}
        headers = headers or {}
    
        timeout = None
        if _request_timeout:
            if isinstance(_request_timeout, (int, ) if six.PY3 else (int, long)):  # noqa: E501,F821
                timeout = urllib3.Timeout(total=_request_timeout)
            elif (isinstance(_request_timeout, tuple) and
                  len(_request_timeout) == 2):
                timeout = urllib3.Timeout(
                    connect=_request_timeout[0], read=_request_timeout[1])
    
        if 'Content-Type' not in headers:
            headers['Content-Type'] = 'application/json'
    
        try:
            # For `POST`, `PUT`, `PATCH`, `OPTIONS`, `DELETE`
            if method in ['POST', 'PUT', 'PATCH', 'OPTIONS', 'DELETE']:
                if query_params:
                    url += '?' + urlencode(query_params)
                if (re.search('json', headers['Content-Type'], re.IGNORECASE) or
                        headers['Content-Type'] == 'application/apply-patch+yaml'):
                    if headers['Content-Type'] == 'application/json-patch+json':
                        if not isinstance(body, list):
                            headers['Content-Type'] = \
                                'application/strategic-merge-patch+json'
                    request_body = None
                    if body is not None:
                        request_body = json.dumps(body)
                    r = self.pool_manager.request(
                        method, url,
                        body=request_body,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                elif headers['Content-Type'] == 'application/x-www-form-urlencoded':  # noqa: E501
                    r = self.pool_manager.request(
                        method, url,
                        fields=post_params,
                        encode_multipart=False,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                elif headers['Content-Type'] == 'multipart/form-data':
                    # must del headers['Content-Type'], or the correct
                    # Content-Type which generated by urllib3 will be
                    # overwritten.
                    del headers['Content-Type']
                    r = self.pool_manager.request(
                        method, url,
                        fields=post_params,
                        encode_multipart=True,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                # Pass a `string` parameter directly in te body to support
                # other content types than Json when `body` argument is
                # provided in serialized form
                elif isinstance(body, str) or isinstance(body, bytes):
                    request_body = body
                    r = self.pool_manager.request(
                        method, url,
                        body=request_body,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                else:
                    # Cannot generate the request from given parameters
                    msg = """Cannot prepare a request message for provided
                             arguments. Please check that your arguments match
                             declared content type."""
                    raise ApiException(status=0, reason=msg)
            # For `GET`, `HEAD`
            else:
                r = self.pool_manager.request(method, url,
                                              fields=query_params,
                                              preload_content=_preload_content,
                                              timeout=timeout,
                                              headers=headers)
        except urllib3.exceptions.SSLError as e:
            msg = "{0}\n{1}".format(type(e).__name__, str(e))
            raise ApiException(status=0, reason=msg)
    
        if _preload_content:
            r = RESTResponse(r)
    
            # In the python 3, the response.data is bytes.
            # we need to decode it to string.
            if six.PY3:
                r.data = r.data.decode('utf8')
    
            # log response body
            logger.debug("response body: %s", r.data)
    
        if not 200 <= r.status <= 299:
>           raise ApiException(http_resp=r)
E           kubernetes.client.exceptions.ApiException: (409)
E           Reason: Conflict
E           HTTP response headers: HTTPHeaderDict({'Audit-Id': 'a908927a-e8fc-4e38-b1cb-d87ccb78bbbb', 'Cache-Control': 'no-cache, private', 'Content-Length': '390', 'Content-Type': 'application/json', 'Date': 'Tue, 10 Feb 2026 11:53:47 GMT', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Kubernetes-Pf-Flowschema-Uid': 'cc44f062-8f4c-4bd6-ae9c-c57c3a743560', 'X-Kubernetes-Pf-Prioritylevel-Uid': 'e328d015-75e1-4f90-8939-9355d8687b43'})
E           HTTP response body: {
E            "kind": "Status",
E            "apiVersion": "v1",
E            "metadata": {},
E            "status": "Failure",
E            "message": "Operation cannot be fulfilled on virtualmachine.kubevirt.io \"vm-stopped-for-reset-test-1770724427-2696245\": VM is not running",
E            "reason": "Conflict",
E            "details": {
E             "name": "vm-stopped-for-reset-test-1770724427-2696245",
E             "group": "kubevirt.io",
E             "kind": "virtualmachine"
E            },
E            "code": 409
E           }

.venv/lib/python3.14/site-packages/kubernetes/client/rest.py:238: ApiException

---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------

--------------------------------------------- test_reset_stopped_vmi_fails ---------------------------------------------
-------------------------------------------------------- SETUP --------------------------------------------------------
2026-02-10T11:53:47.164523 conftest INFO Executing function fixture: term_handler_scope_function
2026-02-10T11:53:47.164718 conftest INFO Executing class fixture: term_handler_scope_class
2026-02-10T11:53:47.165015 conftest INFO Executing function fixture: autouse_fixtures
2026-02-10T11:53:47.165415 conftest INFO Executing class fixture: stopped_fedora_vm
2026-02-10T11:53:47.167471 ocp_resources.resource INFO Trying to get client via new_client_from_config
2026-02-10T11:53:47.269799 ocp_resources.resource INFO kind: VirtualMachine api version: kubevirt.io/v1
2026-02-10T11:53:47.270016 utilities.virt WARNING `os_login_param` not defined for fedora
2026-02-10T11:53:47.277357 utilities.virt INFO Setting random username and password
2026-02-10T11:53:47.325474 ocp_resources VirtualMachine INFO Create VirtualMachine vm-stopped-for-reset-test-1770724427-2696245
2026-02-10T11:53:47.325666 ocp_resources VirtualMachine INFO Posting {'apiVersion': 'kubevirt.io/v1', 'kind': 'VirtualMachine', 'metadata': {'creationTimestamp': None, 'labels': {'kubevirt.io/vm': 'vm-stopped-for-reset-test'}, 'name': 'vm-stopped-for-reset-test-1770724427-2696245'}, 'spec': {'template': {'metadata': {'creationTimestamp': None, 'labels': {'kubevirt.io/vm': 'vm-stopped-for-reset-test-1770724427-2696245', 'kubevirt.io/domain': 'vm-stopped-for-reset-test-1770724427-2696245', 'debugLogs': 'true'}}, 'spec': {'domain': {'cpu': {'cores': 1}, 'memory': {'guest': '1Gi'}, 'devices': {'disks': [{'disk': {'bus': 'virtio'}, 'name': 'containerdisk'}, {'disk': {'bus': 'virtio'}, 'name': 'cloudinitdisk'}], 'interfaces': [{'masquerade': {}, 'name': 'default'}], 'rng': {}}, 'machine': {'type': ''}}, 'networks': [{'name': 'default', 'pod': {}}], 'terminationGracePeriodSeconds': 30, 'volumes': [{'containerDisk': {'image': 'quay.io/openshift-cnv/qe-cnv-tests-fedora:41@sha256:a91659fba4e0258dda1be076dd6e56e34d9bf3dce082e57f939994ce0f124348'}, 'name': 'containerdisk'}, {'name': 'cloudinitdisk', 'cloudInitNoCloud': {'userData': '*******'}}]}}, 'runStrategy': 'Halted'}}
2026-02-10T11:53:47.408494 ocp_resources VirtualMachine INFO Delete VirtualMachine vm-stopped-for-reset-test-1770724427-2696245
2026-02-10T11:53:47.424444 ocp_resources VirtualMachine INFO Deleting {'apiVersion': 'kubevirt.io/v1', 'kind': 'VirtualMachine', 'metadata': {'annotations': {'kubemacpool.io/transaction-timestamp': '2026-02-10T11:53:47.339958306Z'}, 'creationTimestamp': '2026-02-10T11:53:47Z', 'generation': 1, 'labels': {'kubevirt.io/vm': 'vm-stopped-for-reset-test'}, 'managedFields': [{'apiVersion': 'kubevirt.io/v1', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:metadata': {'f:labels': {'.': {}, 'f:kubevirt.io/vm': {}}}, 'f:spec': {'.': {}, 'f:runStrategy': {}, 'f:template': {'.': {}, 'f:metadata': {'.': {}, 'f:creationTimestamp': {}, 'f:labels': {'.': {}, 'f:debugLogs': {}, 'f:kubevirt.io/domain': {}, 'f:kubevirt.io/vm': {}}}, 'f:spec': {'.': {}, 'f:domain': {'.': {}, 'f:cpu': {'.': {}, 'f:cores': {}}, 'f:devices': {'.': {}, 'f:disks': {}, 'f:interfaces': {}, 'f:rng': {}}, 'f:machine': {'.': {}, 'f:type': {}}, 'f:memory': {'.': {}, 'f:guest': {}}}, 'f:networks': {}, 'f:terminationGracePeriodSeconds': {}, 'f:volumes': {}}}}}, 'manager': 'OpenAPI-Generator', 'operation': 'Update', 'time': '2026-02-10T11:53:47Z'}, {'apiVersion': 'kubevirt.io/v1', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:status': {'.': {}, 'f:printableStatus': {}, 'f:volumeSnapshotStatuses': {}}}, 'manager': 'virt-controller', 'operation': 'Update', 'subresource': 'status', 'time': '2026-02-10T11:53:47Z'}], 'name': 'vm-stopped-for-reset-test-1770724427-2696245', 'namespace': 'node-general-test-vmi-reset-comprehensive','resourceVersion': '6310231', 'uid': 'f915553e-7f1b-4ecf-85bd-dca91bb9c0e8'}, 'spec': {'runStrategy': 'Halted', 'template': {'metadata': {'creationTimestamp': None, 'labels': {'debugLogs': 'true', 'kubevirt.io/domain': 'vm-stopped-for-reset-test-1770724427-2696245', 'kubevirt.io/vm': 'vm-stopped-for-reset-test-1770724427-2696245'}}, 'spec': {'architecture': 'amd64', 'domain': {'cpu': {'cores': 1}, 'devices': {'disks': [{'disk': {'bus': 'virtio'}, 'name': 'containerdisk'}, {'disk': {'bus': 'virtio'}, 'name': 'cloudinitdisk'}], 'interfaces': [{'macAddress': '02:22:9f:48:8e:02', 'masquerade': {}, 'name': 'default'}], 'rng': {}}, 'firmware': {'serial': 'c9d2a109-2394-4812-ae3d-d6efdbd87616', 'uuid': '95101af9-9366-4d4e-9875-982aa7026e2c'}, 'machine': {'type': 'pc-q35-rhel9.6.0'}, 'memory': {'guest': '1Gi'}, 'resources': {}}, 'networks': [{'name': 'default', 'pod': {}}], 'terminationGracePeriodSeconds': 30, 'volumes': [{'containerDisk': {'image': 'quay.io/openshift-cnv/qe-cnv-tests-fedora:41@sha256:a91659fba4e0258dda1be076dd6e56e34d9bf3dce082e57f939994ce0f124348'}, 'name': 'containerdisk'}, {'cloudInitNoCloud': {'userData': '*******'}, 'name': 'cloudinitdisk'}]}}}, 'status': {'printableStatus': 'Stopped', 'volumeSnapshotStatuses': [{'enabled': False, 'name': 'containerdisk', 'reason': 'Snapshot is not supported for this volumeSource type [containerdisk]'}, {'enabled': False, 'name': 'cloudinitdisk', 'reason': 'Snapshot is not supported for this volumeSource type [cloudinitdisk]'}]}}
2026-02-10T11:53:47.465426 ocp_resources VirtualMachine INFO Wait until VirtualMachine vm-stopped-for-reset-test-1770724427-2696245 is deleted
2026-02-10T11:53:47.465607 timeout_sampler INFO Waiting for 240 seconds [0:04:00], retry every 1 seconds. (Function: ocp_resources.resource.wait_deleted.lambda: self.exists)
2026-02-10T11:53:48.482792 timeout_sampler INFO Elapsed time: 1.0091767311096191 [0:00:01.009177]
________________________________________________________ ERROR at setup of TestVMIResetErrorHandling.test_reset_paused_vmi_behavior ________________________________________________________

func = <bound method ApiClient.request of <kubernetes.client.api_client.ApiClient object at 0x7facdf701940>>
exceptions_dict = {<class 'urllib3.exceptions.MaxRetryError'>: [], <class 'ConnectionAbortedError'>: [], <class 'ConnectionResetError'>:...eader changed', 'etcdserver: request timed out', 'Internal error occurred: failed calling webhook', 'rpc error:'], ...}
timeout = 30, sleep_time = 5
kwargs = {'headers': {'Content-Type': 'application/json', 'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9...amespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop'}
sampler = <timeout_sampler.TimeoutSampler object at 0x7faccc72bf70>

    @staticmethod
    def retry_cluster_exceptions(
        func: Callable,
        exceptions_dict: dict[type[Exception], list[str]] = DEFAULT_CLUSTER_RETRY_EXCEPTIONS,
        timeout: int = TIMEOUT_10SEC,
        sleep_time: int = 1,
        **kwaargs: Any,
    ) -> Any:
        try:
            sampler = TimeoutSampler(
                wait_timeout=timeout,
                sleep=sleep_time,
                func=func,
                print_log=False,
                exceptions_dict=exceptions_dict,
                **kwargs,
            )
>           for sample in sampler:
                          ^^^^^^^

.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1147: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <timeout_sampler.TimeoutSampler object at 0x7faccc72bf70>

    def __iter__(self) -> Any:
        """
        Call `func` and yield the result, or raise an exception on timeout.
    
        Yields:
            any: Return value from `func`
    
        Raises:
            TimeoutExpiredError: if `func` takes longer than `wait_timeout` seconds to return a value
        """
        timeout_watch = TimeoutWatch(timeout=self.wait_timeout)
        if self.print_log:
            log = (
                f"Waiting for {self.wait_timeout} seconds"
                f" [{datetime.timedelta(seconds=self.wait_timeout)}], retry every"
                f" {self.sleep} seconds."
            )
    
            if self.print_func_log:
                log += f" ({self._func_log})"
    
            LOGGER.info(log)
    
        last_exp = None
        elapsed_time = None
        while timeout_watch.remaining_time() > 0:
            try:
                elapsed_time = self.wait_timeout - timeout_watch.remaining_time()
                yield self.func(*self.func_args, **self.func_kwargs)
                time.sleep(self.sleep)
                elapsed_time = None
    
            except Exception as exp:
                last_exp = exp
                elapsed_time = self.wait_timeout - timeout_watch.remaining_time()
    
                if not self._should_ignore_exception(exp=last_exp):
>                   raise TimeoutExpiredError(
                        self._get_exception_log(exp=last_exp), last_exp=last_exp, elapsed_time=elapsed_time
                    )
E                   timeout_sampler.TimeoutExpiredError: Timed Out: 30
E                   Function: kubernetes.client.api_client.request  Kwargs: {'url': 'https://api.c01-mv-421.rhos-psi.cnv-qe.rhood.us:6443/apis/subresources.kubevirt.io/v1/namespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop', 'method': 'PUT', 'headers': {'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9b-f8PI', 'Content-Type': 'application/json'}}
E                   Last exception: ApiException: (409)
E                   Reason: Conflict
E                   HTTP response headers: HTTPHeaderDict({'Audit-Id': 'a908927a-e8fc-4e38-b1cb-d87ccb78bbbb', 'Cache-Control': 'no-cache, private', 'Content-Length': '390', 'Content-Type': 'application/json', 'Date': 'Tue, 10 Feb 2026 11:53:47 GMT', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Kubernetes-Pf-Flowschema-Uid': 'cc44f062-8f4c-4bd6-ae9c-c57c3a743560', 'X-Kubernetes-Pf-Prioritylevel-Uid': 'e328d015-75e1-4f90-8939-9355d8687b43'})
E                   HTTP response body: {
E                    "kind": "Status",
E                    "apiVersion": "v1",
E                    "metadata": {},
E                    "status": "Failure",
E                    "message": "Operation cannot be fulfilled on virtualmachine.kubevirt.io \"vm-stopped-for-reset-test-1770724427-2696245\": VM is not running",
E                    "reason": "Conflict",
E                    "details": {
E                     "name": "vm-stopped-for-reset-test-1770724427-2696245",
E                     "group": "kubevirt.io",
E                     "kind": "virtualmachine"
E                    },
E                    "code": 409
E                   }
E                   .
E                   Elapsed time: 0.036036014556884766 [0:00:00.036036]

.venv/lib/python3.14/site-packages/timeout_sampler/__init__.py:171: TimeoutExpiredError

The above exception was the direct cause of the following exception:

unprivileged_client = <kubernetes.dynamic.client.DynamicClient object at 0x7facdf702520>, namespace = <ocp_resources.namespace.Namespace object at 0x7facde27eb10>

    @pytest.fixture(scope="class")
    def stopped_fedora_vm(unprivileged_client, namespace):
        """
        Stopped Fedora VirtualMachine for negative testing.
    
        Yields:
            VirtualMachine: Stopped VM
        """
        name = "vm-stopped-for-reset-test"
        with VirtualMachineForTests(
            client=unprivileged_client,
            name=name,
            namespace=namespace.name,
            body=fedora_vm_body(name=name),
        ) as vm:
>           vm.stop(wait=True)

tests/virt/node/general/test_vmi_reset_comprehensive.py:90: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ __ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.14/site-packages/ocp_resources/virtual_machine.py:105: in stop
    self.api_request(method="PUT", action="stop")
.venv/lib/python3.14/site-packages/ocp_resources/virtual_machine.py:79: in api_request
    return super().api_request(
.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1337: in api_request
    response = self.retry_cluster_exceptions(
.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1152: in retry_cluster_exceptions
    raise exp.last_exp from exp
.venv/lib/python3.14/site-packages/timeout_sampler/__init__.py:162: in __iter__
    yield self.func(*self.func_args, **self.func_kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.14/site-packages/kubernetes/client/api_client.py:399: in request
    return self.rest_client.PUT(url,
.venv/lib/python3.14/site-packages/kubernetes/client/rest.py:289: in PUT
    return self.request("PUT", url,
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <kubernetes.client.rest.RESTClientObject object at 0x7facdf702b10>, method = 'PUT'
url = 'https://api.c01-mv-421.rhos-psi.cnv-qe.rhood.us:6443/apis/subresources.kubevirt.io/v1/namespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop'
query_params = None, headers = {'Content-Type': 'application/json', 'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9b-f8PI'}, body = None, post_params = {}
_preload_content = True, _request_timeout = None

    def request(self, method, url, query_params=None, headers=None,
                body=None, post_params=None, _preload_content=True,
                _request_timeout=None):
        """Perform requests.
    
        :param method: http request method
        :param url: http request url
        :param query_params: query parameters in the url
        :param headers: http request headers
        :param body: request json body, for `application/json`
        :param post_params: request post parameters,
                            `application/x-www-form-urlencoded`
                            and `multipart/form-data`
        :param _preload_content: if False, the urllib3.HTTPResponse object will
                                 be returned without reading/decoding response
                                 data. Default is True.
        :param _request_timeout: timeout setting for this request. If one
                                 number provided, it will be total request
                                 timeout. It can also be a pair (tuple) of
                                 (connection, read) timeouts.
        """
        method = method.upper()
        assert method in ['GET', 'HEAD', 'DELETE', 'POST', 'PUT',
                          'PATCH', 'OPTIONS']
    
        if post_params and body:
            raise ApiValueError(
                "body parameter cannot be usedd with post_params parameter."
            )
    
        post_params = post_params or {}
        headers = headers or {}
    
        timeout = None
        if _request_timeout:
            if isinstance(_request_timeout, (int, ) if six.PY3 else (int, long)):  # noqa: E501,F821
                timeout = urllib3.Timeout(total=_request_timeout)
            elif (isinstance(_request_timeout, tuple) and
                  len(_request_timeout) == 2):
                timeout = urllib3.Timeout(
                    connect=_request_timeout[0], read=_request_timeout[1])
    
        if 'Content-Type' not in headers:
            headers['Content-Type'] = 'application/json'
    
        try:
            # For `POST`, `PUT`, `PATCH`, `OPTIONS`, `DELETE`
            if method in ['POST', 'PUT', 'PATCH', 'OPTIONS', 'DELETE']:
                if query_params:
                    url += '?' + urlencode(query_params)
                if (re.search('json', headers['Content-Type'], re.IGNORECASE) or
                        headers['Content-Type'] == 'application/apply-patch+yaml'):
                    if headers['Content-Type'] == 'application/json-patch+json':
                        if not isinstance(body, list):
                            headers['Content-Type'] = \
                                'application/strategic-merge-patch+json'
                    request_body = None
                    if body is not None:
                        request_body = json.dumps(body)
                    r = self.pool_manager.request(
                        method, url,
                        body=request_body,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                elif headers['Content-Type'] == 'application/x-www-form-urlencoded':  # noqa: E501
                    r = self.pool_manager.request(
                        method, url,
                        fields=post_params,
                        encode_multipart=False,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                elif headers['Content-Type'] == 'multipart/form-data':
                    # must del headers['Content-Type'], or the correct
                    # Content-Type which generated by urllib3 will be
                    # overwritten.
                    del headers['Content-Type']
                    r = self.pool_manager.request(
                        method, url,
                        fields=post_params,
                        encode_multipart=True,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                # Pass a `string` parameter directly in the body to support
                # other content types than Json when `body` argument is
                # provided in serialized form
                elif isinstance(body, str) or isinstance(body, bytes):
                    request_body = body
                    r = self.pool_manager.request(
                        method, url,
                        body=request_body,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                else:
                    # Cannot generate the request from given parameters
                    msg = """Cannot prepare a request message for provided
                             arguments. Please check that your arguments match
                             declared content type."""
                    raise ApiException(status=0, reason=msg)
            # For `GET`, `HEAD`
            else:
                r = self.pool_manager.request(method, url,
                                              fields=query_params,
                                              preload_content=_preload_content,
                                              timeout=timeout,
                                              headrs=headers)
        except urllib3.exceptions.SSLError as e:
            msg = "{0}\n{1}".format(type(e).__name__, str(e))
            raise ApiException(status=0, reason=msg)
    
        if _preload_content:
            r = RESTResponse(r)
    
            # In the python 3, the response.data is bytes.
            # we need to decode it to string.
            if six.PY3:
                r.data = r.data.decode('utf8')
    
            # log response body
            logger.debug("response body: %s", r.data)
    
        if not 200 <= r.status <= 299:
>           raise ApiException(http_resp=r)
E           kubernetes.client.exceptions.ApiException: (409)
E           Reason: Conflict
E           HTTP response headers: HTTPHeaderDict({'Audit-Id': 'a908927a-e8fc-4e38-b1cb-d87ccb78bbbb', 'Cache-Control': 'no-cache, private', 'Content-Length': '390', 'Content-Type': 'application/json', 'Date': 'Tue, 10 Feb 2026 11:53:47 GMT', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Kubernetes-Pf-Flowschema-Uid': 'cc44f062-8f4c-4bd6-ae9c-c57c3a743560', 'X-Kubernetes-Pf-Prioritylevel-Uid': 'e328d015-75e1-4f90-8939-9355d8687b43'})
E           HTTP response body: {
E            "kind": "Status",
E            "apiVersion": "v1",
E            "metadata": {},
E            "status": "Failure",
E            "message": "Operation cannot be fulfilled on virtualmachine.kubevirt.io \"vm-stopped-for-reset-test-1770724427-2696245\": VM is not running",
E            "reason": "Conflict",
E            "details": {
E             "name": "vm-stopped-for-reset-test-1770724427-2696245",
E             "group": "kubevirt.io",
E             "kind": "virtualmachine"
E            },
E            "code": 409
E           }

.venv/lib/python3.14/site-packages/kubernetes/client/rest.py:238: ApiException
_______________________________________________________ ERROR at setup of TestVMIResetErrorHandling.test_reset_nonexistent_vmi_fails _______________________________________________________

func = <bound method ApiClient.request of <kubernetes.client.api_client.ApiClient object at 0x7facdf701940>>
exceptions_dict = {<class 'urllib3.exceptions.MaxRetryError'>: [], <class 'ConnectionAbortedError'>: [], <class 'ConnectionResetError'>:...eader changed', 'etcdserver: request timed out', 'Internal error occurred: failed calling webhook', 'rpc error:'], ...}
timeout = 30, sleep_time = 5
kwargs = {'headers': {'Content-Type': 'application/json', 'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9...amespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop'}
sampler = <timeout_sampler.TimeoutSampler object at 0x7faccc72bf70>

    @staticmethod
    def retry_cluster_exceptions(
        func: Callable,
        exceptions_dict: dict[type[Exception], list[str]] = DEFAULT_CLUSTER_RETRY_EXCEPTIONS,
        timeout: int = TIMEOUT_10SEC,
        sleep_time: int = 1,
        **kwargs: Any,
    ) -> Any:
        try:
            sampler = TimeoutSampler(
                waitt_timeout=timeout,
                sleep=sleep_time,
                func=func,
                print_log=False,
                exceptions_dict=exceptions_dict,
                **kwargs,
            )
>           for sample in sampler:
                          ^^^^^^^

.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1147: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <timeout_sampler.TimeoutSampler object at 0x7faccc72bf70>

    def __iter__(self) -> Any:
        """
        Call `func` and yield the result, or raise an exception on timeout.
    
        Yields:
            any: Return value from `func`
    
        Raises:
            TimeoutExpiredError: if `func` takes longer than `wait_timeout` seconds to return a value
        """
        timeout_watch = TimeoutWatch(timeout=self.wait_timeout)
        if self.print_log:
            log = (
                f"Waiting for {self.wait_timeout} seconds"
                f" [{datetime.timedelta(seconds=self.wait_timeout)}], retry every"
                f" {self.sleep} seconds."
            )
    
            if self.print_func_log:
                log += f" ({self._func_log})"
    
            LOGGER.info(log)
    
        last_exp = None
        elapsed_time = None
        while timeout_watch.remaining_time() > 0:
            try:
                elapsed_time = self.wait_timeout - timeout_watch.remaining_time()
                yield self.func(*self.func_args, **self.func_kwargs)
                time.sleep(self.sleep)
                elapsed_time = None
    
            except Exception as exp:
                last_exp = exp
                elapsed_time = self.wait_timeout - timeout_watch.remaining_time()
    
                if not self._should_ignore_exception(exp=last_exp):
>                   raise TimeoutExpiredError(
                        self._get_exception_log(exp=last_exp), last_exp=last_exp, elapsed_time=elapsed_time
                    )
E                   timeout_sampler.TimeoutExpiredError: Timed Out: 30
E                   Function: kubernetes.client.api_client.request  Kwargs: {'url': 'https://api.c01-mv-421.rhos-psi.cnv-qe.rhood.us:6443/apis/subresources.kubevirt.io/v1/namespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop', 'method': 'PUT', 'headers': {'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9b-f8PI', 'Content-Type': 'application/json'}}
E                   Last exception: ApiException: (409)
E                   Reason: Conflict
E                   HTTP response headers: HTTPHeaderDict({'Audit-Id': 'a908927a-e8fc-4e38-b1cb-d87ccb78bbbb', 'Cache-Control': 'no-cache, private', 'Content-Length': '390', 'Content-Type': 'application/json', 'Date': 'Tue, 10 Feb 2026 11:53:47 GMT', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Kubernetes-Pf-Flowschema-Uid': 'cc44f062-8f4c-4bd6-ae9c-c57c3a743560', 'X-Kubernetes-Pf-Prioritylevel-Uid': 'e328d015-75e1-4f90-8939-9355d8687b43'})
E                   HTTP response body: {
E                    "kind": "Status",
E                    "apiVersion": "v1",
E                    "metadata": {},
E                    "status": "Failure",
E                    "message": "Operation cannot be fulfilled on virtualmachine.kubevirt.io \"vm-stopped-for-reset-test-1770724427-2696245\": VM is not running",
E                    "reason": "Conflict",
E                    "details": {
E                     "name": "vm-stopped-for-reset-test-1770724427-2696245",
E                     "group": "kubevirt.io",
E                     "kind": "virtualmachine"
E                    },
E                    "code": 409
E                   }
E                   .
E                   Elapsed time: 0.036036014556884766 [0:00:00.036036]

.venv/lib/python3.14/site-packages/timeout_sampler/__init__.py:171: TimeoutExpiredError

The above exception was the direct cause of the following exception:

unprivileged_client = <kubernetes.dynamic.client.DynamicClient object at 0x7facdf702520>, namespace = <ocp_resources.namespace.Namespace object at 0x7facde27eb10>

    @pytest.fixture(scope="class")
    def stopped_fedora_vm(unprivileged_client, namespace):
        """
        Stopped Fedora VirtualMachine for negative testing.
    
        Yields:
            VirtualMachine: Stopped VM
        """
        name = "vm-stopped-for-reset-test"
        with VirtualMachineForTests(
            client=unprivileged_client,
            name=name,
            namespace=namespace.name,
            body=fedora_vm_body(name=name),
        ) as vm:
>           vm.stop(wait=True)

tests/virt/node/general/test_vmi_reset_comprehensive.py:90: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.14/site-packages/ocp_resources/virtual_machine.py105: in stop
    self.api_request(method="PUT", action="stop")
.venv/lib/python3.14/site-packages/ocp_resources/virtual_machine.py:79: in api_request
    return super().api_request(
.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1337: in api_request
    response = self.retry_cluster_exceptions(
.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1152: in retry_cluster_exceptions
    raise exp.last_exp from exp
.venv/lib/python3.14/site-packages/timeout_sampler/__init__.py:162: in __iter__
    yield self.func(*self.func_args, **self.func_kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.14/site-packages/kubernetes/client/api_client.py:399: in request
    return self.rest_client.PUT(url,
.venv/lib/python3.14/site-packages/kubernetes/client/rest.py:289: in PUT
    return self.request("PUT", url,
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <kubernetes.client.rest.RESTClientObject object at 0x7facdf702b10>, method = 'PUT'
url = 'https://api.c01-mv-421.rhos-psi.cnv-qe.rhood.us:6443/apis/subresources.kubevirt.io/v1/namespaces/node-general-test-vmi-reset-comprehensive/virtualmachines/vm-stopped-for-reset-test-1770724427-2696245/stop'
query_params = None, headers = {'Content-Type': 'application/json', 'authorization': 'Bearer sha256~Oh8TGKeZLxp5ge4zMh0ARs85jF5Otfk2tAcE9b-f8PI'}, body = None, post_params = {}
_preload_content = True, _request_timeout = None

    def request(self, method, url, query_params=None, headers=None,
                body=None, post_params=None, _preload_content=True,
                _request_timeout=None):
        """Perform requests.
    
        :param method: http request method
        :param url: http request url
        :param query_params: query parameters in the url
        :param headers: http request headers
        :param body: request json body, for `application/json`
        :param post_params: request post parameters,
                            `application/x-www-form-urlencoded`
                            and `multipart/form-data`
        :param _preload_content: if False, the urllib3.HTTPResponse object will
                                 be returned without reading/decoding response
                                 data. Default is True.
        :param _request_timeout: timeout setting for this request. If one
                                 number provided, it will be total request
                                 timeout. It can also be a pair (tuple) of
                                 (connection, read) timeouts.
        """
        method = method.upper()
        assert method in ['GET', 'HEAD', 'DELETE', 'POST', 'PUT',
                          'PATCH', 'OPTIONS']
    
        if post_params and body:
            raise ApiValueError(
                "body parameter cannot be used with post_params parameter."
            )
    
        post_params = post_params or {}
         headers = headers or {}
    
        timeout = None
        if _request_timeout:
            if isinstance(_request_timeout, (int, ) if six.PY3 else (int, long)):  # noqa: E501,F821
                timeout = urllib3.Timeout(total=_request_timeout)
            elif (isinstance(_request_timeout, tuple) and
                  len(_request_timeout) == 2):
                timeout = urllib3.Timeout(
                    connect=_request_timeout[0], read=_request_timeout[1])
    
        if 'Content-Type' not in headers:
            headers['Content-Type'] = 'application/json'
    
        try:
            # For `POST`, `PUT`, `PATCH`, `OPTIONS`, `DELETE`
            if method in ['POST', 'PUT', 'PATCH', 'OPTIONS', 'DELETE']:
                if query_params:
                    url += '?' + urlencode(query_params)
                if (re.search('json', headers['Content-Type'], re.IGNORECASE) or
                        headers['Content-Type'] == 'application/apply-patch+yaml'):
                    if headers['Content-Type'] == 'application/json-patch+json':
                        if not isinstance(body, list):
                            headers['Content-Type'] = \
                                'application/strategic-merge-patch+json'
                    request_body = None
                    if body is not None:
                        request_body = json.dumps(body)
                    r = self.pool_manager.request(
                        method, url,
                        body=request_body,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                elif headers['Content-Type'] == 'application/x-www-form-urlencoded':  # noqa: E501
                    r = self.pool_manager.request(
                        method, url,
                        fields=post_params,
                        encode_multipart=False,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                elif headers['Content-Type'] == 'multipart/form-data':
                    # must del headers['Content-Type'], or the correct
                    # Content-Type which generated by urllib3 will be
                    # overwritten.
                    del headers['Content-Type']
                    r = self.pool_manager.request(
                        method, url,
                        fields=post_params,
                        encode_multipart=True,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                # Pass a `string` parameter directly in the body to support
                # other content types than Json when `body` argument is
                # provided in serialized form
                elif isinstance(body, str) or isinstance(body, bytes):
                    request_body = body
                    r = self.pool_manager.request(
                        method, url,
                        body=request_body,
                        preload_content=_preload_content,
                        timeout=timeout,
                        headers=headers)
                else:
                    # Cannot generate the request from given parameters
                    msg = """Cannot prepare a request message for provided
                             arguments. Please check that your arguments match
                             declared content type."""
                    raise ApiException(status=0, reason=msg)
            # For `GET`, `HEAD`
            else:
                r = self.pool_manager.request(method, url,
                                              fields=query_params,
                                              preload_content=_preload_content,
                                              timeout=timeout,
                                              headers=headers)
        except urllib3.exceptions.SSLError as e:
            msg = "{0}\n{1}".format(type(e).__name__, str(e))
            raise ApiException(status=0, reason=msg)
    
        if _preload_content:
            r = RESTResponse(r)
    
            # In the python 3, the response.data is bytes.
            # we need to decode it to string.
            if six.PY3:
                r.data = r.data.decode('utf8')
    
            # log response body
            logger.debug("response body: %s", r.data)
    
        if not 200 <= r.status <= 299:
>           raise ApiException(http_resp=r)
E           kubernetes.client.exceptions.ApiException: (409)
E           Reason: Conflict
E           HTTP response headers: HTTPHeaderDict({'Audit-Id': 'a908927a-e8fc-4e38-b1cb-d87ccb78bbbb', 'Cache-Control': 'no-cache, private', 'Content-Length': '390', 'Content-Type': 'application/json', 'Date': 'Tue, 10 Feb 2026 11:53:47 GMT', 'Strict-Transport-Security': 'max-age=31536000; includeSubDomains; preload', 'X-Kubernetes-Pf-Flowschema-Uid': 'cc44f062-8f4c-4bd6-ae9c-c57c3a743560', 'X-Kubernetes-Pf-Prioritylevel-Uid': 'e328d015-75e1-4f90-8939-9355d8687b43'})
E           HTTP response body: {
E            "kind": "Status",
E            "apiVersion": "v1",
E            "metadata": {},
E            "status": "Failure",
E            "message": "Operation cannot be fulfilled on virtualmachine.kubevirt.io \"vm-stopped-for-reset-test-1770724427-2696245\": VM is not running",
E            "reason": "Conflict",
E            "details": {
E             "name": "vm-stopped-for-reset-test-1770724427-2696245",
E             "group": "kubevirt.io",
E             "kind": "virtualmachine"
E            },
E            "code": 409
E           }

.venv/lib/python3.14/site-packages/kubernetes/client/rest.py:238: ApiException
========================================================================================= FAILURES =========================================================================================
_________________________________________________________________ TestVMIResetRBAC.test_user_with_edit_role_can_reset_vmi __________________________________________________________________

self = <tests.virt.node.general.test_vmi_reset_comprehensive.TestVMIResetRBAC object at 0x7facdf63ca50>
running_fedora_vm = <utilities.virt.VirtualMachineForTests object at 0x7facde0fdd30>
service_account_with_edit_role = <ocp_resources.service_account.ServiceAccount object at 0x7facde0f5590>, namespace = <ocp_resources.namespace.Namespace object at 0x7facde27eb10>

    @pytest.mark.polarion("CNV-12378")
    def test_user_with_edit_role_can_reset_vmi(
        self,
        running_fedora_vm,
        service_account_with_edit_role,
        namespace,
    ):
        """
        Test that a user with 'edit' role can successfully reset a VMI.
    
        Steps:
            1. Create client impersonating service account with 'edit' role
            2. Execute reset operation on VMI via API using impersonated client
    
        Expected:
            - Reset operation succeeds without authorization error
        """
        LOGGER.info(f"Creating client imppersonating service account {service_account_with_edit_role.name}")
        sa_client = get_client(
            config_file=None,
>           token=service_account_with_edit_role.get_sa_token(),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
E       AttributeError: 'ServiceAccount' object has no attribute 'get_sa_token'

tests/virt/node/general/test_vmi_reset_comprehensive.py:381: AttributeError
---------------------------------------------------------------------------------- Captured stderr setup -----------------------------------------------------------------------------------

---------------------------------------- test_user_with_edit_role_can_reset_vmi ----------------------------------------
-------------------------------------------------------- SETUP --------------------------------------------------------
2026-02-10T11:52:46.784133 conftest INFO Executing function fixture: term_handler_scope_function
2026-02-10T11:52:46.784326 conftest INFO Executing class fixture: termhandler_scope_class
2026-02-10T11:52:46.784653 conftest INFO Executing function fixture: autouse_fixtures
2026-02-10T11:52:46.784991 conftest INFO Executing class fixture: running_fedora_vm
2026-02-10T11:52:46.787257 ocp_resources.resource INFO Trying to get client via new_client_from_config --- [DuplicateFilter: Last log `kind: VirtualMachineInstance api version: kubevirt.io/v1` repeated 28 times]
2026-02-10T11:52:46.890993 ocp_resources.resource INFO kind: VirtualMachine api version: kubevirt.io/v1
2026-02-10T11:52:46.891263 utilities.virt WARNING `os_login_param` not defined for fedora
2026-02-10T11:52:46.949012 ocp_resources VirtualMachine INFO Create VirtualMachine vm-for-reset-test-1770724366-8908286
2026-02-10T11:52:46.949395 ocp_resources VirtualMachine INFO Posting {'apiVersion': 'kubevirt.io/v1', 'kind': 'VirtualMachine', 'metadata': {'creationTimestamp': None, 'labels': {'kubevirt.io/vm': 'vm-for-reset-test'}, 'name': 'vm-for-reset-test-1770724366-8908286'}, 'spec': {'template': {'metadata': {'creationTimestamp': None, 'labels': {'kubevirt.io/vm': 'vm-for-reset-test-1770724366-8908286', 'kubevirt.io/domain': 'vm-for-reset-test-1770724366-8908286', 'debugLogs': 'true'}}, 'spec': {'domain': {'cpu': {'cores': 1}, 'memory': {'guest': '1Gi'}, 'devices': {'disks': [{'disk': {'bus': 'virtio'}, 'name': 'containerdisk'}, {'disk': {'bus': 'virtio'}, 'name': 'cloudinitdisk'}], 'interfaces': [{'masquerade': {}, 'name': 'default'}], 'rng': {}}, 'machine': {'type': ''}}, 'networks': [{'name': 'default', 'pod': {}}], 'terminationGracePeriodSeconds': 30, 'volumes': [{'containerDisk': {'image': 'quay.io/openshift-cnv/qe-cnv-tests-fedora:41@sha256:a91659fba4e0258dda1be076dd6e56e34d9bf3dce082e57f939994ce0f124348'}, 'name': 'containerdisk'}, {'name': 'cloudinitdisk', 'cloudInitNoCloud': {'userData': '*******'}}]}}, 'runStrategy': 'Halted'}}
2026-02-10T11:52:46.899060 utilities.virt INFO Setting random username and password
2026-02-10T11:52:47.152831 timeout_sampler INFO Waiting for 5 seconds [0:00:05], retry every 1 seconds. (Function: utilities.virt.<locals>.lambda: vm.instance.get)
2026-02-10T11:52:47.167715 timeout_sampler INFO Elapsed time: 0.00027441978454589844 [0:00:00.000274]
2026-02-10T11:52:47.168011 ocp_resources.resource INFO kind: VirtualMachineInstance api version: kubevirt.io/v1
2026-02-10T11:52:47.168129 ocp_resources VirtualMachineInstance INFO Wait for VirtualMachineInstance vm-for-reset-test-1770724366-8908286 status to be Running
2026-02-10T11:52:47.168295 timeout_sampler INFO Waiting for 240 seconds [0:04:00], retry every 1 seconds. (Function: ocp_resources.resource.wait_for_status.lambda: self.exists)
2026-02-10T11:52:48.183331 ocp_resources VirtualMachineInstance INFO Status of VirtualMachineInstance vm-for-reset-test-1770724366-8908286 is Scheduling
2026-02-10T11:52:56.257727 ocp_resources VirtualMachineInstance INFO Status of VirtualMachineInstance vm-for-reset-test-1770724366-8908286 is Scheduled
2026-02-10T11:53:00.290861 ocp_resources VirtualMachineInstance INFO Status of VirtualMachineInstance vm-for-reset-test-1770724366-8908286 is Running
2026-02-10T11:53:00.291099 timeout_sampler INFO Elapsed time: 13.114286422729492 [0:00:13.114286]
2026-02-10T11:53:00.291897 ocp_resources VirtualMachineInstance INFO Wait for VirtualMachineInstance/vm-for-reset-test-1770724366-8908286's 'AgentConnected' condition to be 'True'
2026-02-10T11:53:00.292111 ocp_resources VirtualMachineInstance INFO Wait until VirtualMachineInstance vm-for-reset-test-1770724366-8908286 is created
2026-02-10T11:53:00.292758 timeout_sampler INFO Waiting for 720 seconds [0:12:00], retry every 1 seconds. (Function: ocp_resources.resource.wait.lambda: self.exists)
2026-02-10T11:53:00.291700 utilities.virt INFO Wait until guest agent is active on vm-for-reset-test-1770724366-8908286
2026-02-10T11:53:00.300287 timeout_sampler INFO Elapsed time: 0.00015616416931152344 [0:00:00.000156]
2026-02-10T11:53:00.300629 timeout_sampler INFO Waiting for 719.9914655685425 seconds [0:11:59.991466], retry every 1 seconds. (Function: ocp_resources.resource.wait_for_condition.lambda: self.instance)
2026-02-10T11:53:38.694930 timeout_sampler INFO Elapsed time: 38.385860204696655 [0:00:38.385860]
2026-02-10T11:53:38.696602 timeout_sampler INFO Waiting for 720 seconds [0:12:00], retry every 1 seconds. (Function: utilities.virt.<locals>.lambda: vmi.instance)
2026-02-10T11:53:38.696399 utilities.virt INFO Wait for vm-for-reset-test-1770724366-8908286 network interfaces
2026-02-10T11:53:38.703966 timeout_sampler INFO Elapsed time: 0.0003209114074707031 [0:00:00.000321]
2026-02-10T11:53:38.704209 utilities.virt INFO Wait for vm-for-reset-test-1770724366-8908286 SSH connectivity.
2026-02-10T11:53:38.704308 utilities.virt INFO SSH command: ssh -o 'ProxyCommand=virtctl port-forward --stdio=true vm/vm-for-reset-test-1770724366-8908286/node-general-test-vmi-reset-comprehensive 22' qeNkPAHRWSllpfbt@vm-for-reset-test-1770724366-8908286
2026-02-10T11:53:38.716602 timeout_sampler INFO Waiting for 120 seconds [0:02:00], retry every 5 seconds. (Function: rrmngmnt.host.run_command  Kwargs: {'command': ['exit'], 'tcp_timeout': 60})
2026-02-10T11:53:38.716788 Host INFO [vm-for-reset-test-1770724366-8908286] Executing command exit
2026-02-10T11:53:38.865564 paramiko.transport INFO Connected (version 2.0, client OpenSSH_9.8)
2026-02-10T11:53:38.912398 paramiko.transport INFO Authentication (publickey) successful!
2026-02-10T11:53:39.332751 timeout_sampler INFO Elapsed time: 0.000213623046875 [0:00:00.000214]
2026-02-10T11:53:39.334394 ocp_resources ServiceAccount INFO Create ServiceAccount vmi-reset-edit-sa
2026-02-10T11:53:39.334960 ocp_resources ServiceAccount INFO Posting {'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'vmi-reset-edit-sa', 'namespace': 'node-general-test-vmi-reset-comprehensive'}}
2026-02-10T11:53:39.333212 conftest INFO Executing class fixture: service_account_with_edit_role
2026-02-10T11:53:39.362750 ocp_resources.resource INFO kind: RoleBinding api version: rbac.authorization.k8s.io/v1
2026-02-10T11:53:39.363016 ocp_resources RoleBinding INFO Create RoleBinding vmi-reset-edit-sa-edit-binding
2026-02-10T11:53:39.363213 ocp_resources RoleBinding INFO Posting {'apiVersion': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'metadata': {'name': 'vmi-reset-edit-sa-edit-binding', 'namespace': 'node-general-test-vmi-reset-comprehensive'}, 'subjects': [{'kind': 'ServiceAccount', 'name': 'vmi-reset-edit-sa'}], 'roleRef': {'kind': 'ClusterRole', 'name': 'edit', 'apiGroup': 'rbac.authorization.k8s.io'}}
2026-02-10T11:53:39.400785 ocp_resources ServiceAccount INFO Create ServiceAccount vmi-reset-view-sa
2026-02-10T11:53:39.400936 ocp_resources ServiceAccount INFO Posting {'apiVersion': 'v1', 'kind': 'ServiceAccount', 'metadata': {'name': 'vmi-reset-view-sa', 'namespace': 'node-general-test-vmi-reset-comprehensive'}}
2026-02-10T11:53:39.400324 conftest INFO Executing class fixture: service_account_without_reset_permission
2026-02-10T11:53:39.414279 ocp_resources RoleBinding INFO Create RoleBinding vmi-reset-view-sa-view-binding
2026-02-10T11:53:39.414437 ocp_eesources RoleBinding INFO Posting {'apiVersion': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'metadata': {'name': 'vmi-reset-view-sa-view-binding', 'namespace': 'node-general-test-vmi-reset-comprehensive'}, 'subjects': [{'kind': 'ServiceAccount', 'name': 'vmi-reset-view-sa'}], 'roleRef': {'kind': 'ClusterRole', 'name': 'view', 'apiGroup': 'rbac.authorization.k8s.io'}}
___________________________________________________________ TestVMIResetRBAC.test_user_without_reset_permission_cannot_reset_vmi ___________________________________________________________

self = <tests.virt.node.general.test_vmi_reset_comprehensive.TestVMIResetRBAC object at 0x7facdf63ccd0>
running_fedora_vm = <utilities.virt.VirtualMachineForTests object at 0x7facde0fdd30>
service_account_without_reset_permission = <ocp_resources.service_account.ServiceAccount object at 0x7facde0f5d10>, namespace = <ocp_resources.namespace.Namespace object at 0x7facde27eb10>

    @pytest.mark.polarion("CNV-12379")
    def test_user_without_reset_permission_cannot_reset_vmi(
        self,
        running_fedora_vm,
        service_account_without_reset_permission,
        namespace,
    ):
        """
        [NEGATIVE] Test that a user without reset permission cannot reset a VMI.
    
        Steps:
            1. Create client impersonating service account without reset permission
            2. Attempt to execute reset operation on VMI via API
    
        Expected:
            - Reset operation fails with HTTP 403 Forbidden error
        """
        LOGGER.info(
            f"Creating client impersonating service account {service_account_without_reset_permission.name}"
        )
        sa_client = get_client(
            config_file=None,
>           token=service_account_without_reset_permission.get_sa_token(),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
E       AttributeError: 'ServiceAccount' object has no attribute 'get_sa_token'

tests/virt/node/general/test_vmi_reset_comprehensive.py:420: AttributeError
--------------------------------------------------------------------------------- Captured stderr teardown ---------------------------------------------------------------------------------
2026-02-10T11:53:39.727261 ocp_resources RoleBinding INFO Delete RoleBinding vmi-reset-view-sa-view-binding
self = <tests.virt.node.general.test_vmi_reset_comprehensive.TestVMIResetRBAC object at 0x7facdf63ccd0>
running_fedora_vm = <utilities.virt.VirtualMachineForTests object at 0x7facde0fdd30>
service_account_without_reset_permission = <ocp_resources.service_account.ServiceAccount object at 0x7facde0f5d10>, namespace = <ocp_resources.namespace.Namespace object at 0x7facde27eb10>

    @pytest.mark.polarion("CNV-12379")
    def test_user_without_reset_permission_cannot_reset_vmi(
        self,
        running_fedora_vm,
        service_account_without_reset_permission,
        namespace,
    ):
        """
        [NEGATIVE] Test that a user without reset permission cannot reset a VMI.
    
        Steps:
            1. Create client impersonating service account without reset permission
            2. Attempt to execute reset operation on VMI via API
    
        Expected:
            - Reset operation fails with HTTP 403 Forbidden error
        """
        LOGGER.info(
            f"Creating client impersonating service account {service_account_without_reset_permission.name}"
        )
        sa_client = get_client(
            config_file=None,
>           token=service_account_without_reset_permission.get_sa_token(),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
E       AttributeError: 'ServiceAccount' object has no attribute 'get_sa_token'

tests/virt/node/general/test_vmi_reset_comprehensive.py:420: AttributeError
------------------------------------------------------- TEARDOWN -------------------------------------------------------
2026-02-10T11:53:39.737320 ocp_resources RoleBinding INFO Deleting {'kind': 'RoleBinding', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'metadata': {'name': 'vmi-reset-view-sa-view-binding', 'namespace': 'node-general-test-vmi-reset-comprehensive', 'uid': 'a6317311-b9f6-420b-953d-a8f774196c49', 'resourceVersion': '6310067', 'creationTimestamp': '2026-02-10T11:53:39Z', 'managedFields': [{'manager': 'OpenAPI-Generator', 'operation': 'Update', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'time': '2026-02-10T11:53:39Z', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:roleRef': {}, 'f:subjects': {}}}]}, 'subjects': [{'kind': 'ServiceAccount', 'name': 'vmi-reset-view-sa'}], 'roleRef': {'apiGroup': 'rbac.authorization.k8s.io', 'kind': 'ClusterRole', 'name': 'view'}}
2026-02-10T11:53:39.775640 ocp_resources RoleBinding INFO Wait until RoleBinding vmi-reset-view-sa-view-binding is deleted
2026-02-10T11:53:39.775846 timeout_sampler INFO Waiting for 240 seconds [0:04:00], retry every 1 seconds. (Function: ocp_resources.resource.wait_deleted.lambda: self.exists)
2026-02-10T11:53:39.782813 timeout_sampler INFO Elapsed time: 9.489059448242188e-05 [0:00:00.000095]
2026-02-10T11:53:39.783079 ocp_resources ServiceAccount INFO Delete ServiceAccount vmi-reset-view-sa
2026-02-10T11:53:39.794961 ocp_resources ServiceAccount INFO Deleting {'kind': 'ServiceAccount', 'apiVersion': 'v1', 'metadata': {'name': 'vmi-reset-view-sa', 'namespace': 'node-general-test-vmi-reset-comprehensive', 'uid': '94e0f29d-966d-4a1d-98c5-fba0f2916817', 'resourceVersion': '6310061', 'creationTimestamp': '2026-02-10T11:53:39Z', 'annotations': {'openshift.io/internal-registry-pull-secret-ref': 'vmi-reset-view-sa-dockercfg-b2r29'}, 'managedFields': [{'manager': 'openshift.io/image-registry-pull-secrets_service-account-controller', 'operation': 'Apply', 'apiVersion': 'v1', 'time': '2026-02-10T11:53:39Z', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:imagePullSecrets': {}, 'f:metadata': {'f:annotations': {'f:openshift.io/internal-registry-pull-secret-ref': {}}}, 'f:secrets': {'k:{"name":"vmi-reset-view-sa-dockercfg-b2r29"}': {}}}}]}, 'secrets': [{'name': 'vmi-reset-view-sa-dockercfg-b2r29'}], 'imagePullSecrets': [{'name': 'vmi-reset-view-sa-dockercfg-b2r29'}]}
2026-02-10T11:53:39.807267 ocp_resources ServiceAccount INFO Wait until ServiceAccount vmi-reset-view-sa is deleted
2026-02-10T11:53:39.807541 timeout_sampler INFO Waiting for 240 seconds [0:04:00], retry every 1 seconds. (Function: ocp_resources.resource.wait_deleted.lambda: self.exists)
2026-02-10T11:53:39.816702 timeout_sampler INFO Elapsed time: 0.00011157989501953125 [0:00:00.000112]
2026-02-10T11:53:39.817001 ocp_resources RoleBinding INFO Delete RoleBinding vmi-reset-edit-sa-edit-binding
2026-02-10T11:53:39.827036 ocp_resources RoleBinding INFO Deleting {'kind': 'RoleBinding', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'metadata': {'name': 'vmi-reset-edit-sa-edit-binding', 'namespace': 'node-general-test-vmi-reset-comprehensive', 'uid': '6428fbe8-142a-4597-9c05-1a7fbae5e20f', 'resourceVersion': '6310057', 'creationTimestamp': '2026-02-10T11:53:39Z', 'managedFields': [{'manager': 'OpenAPI-Generator', 'operation': 'Update', 'apiVersion': 'rbac.authorization.k8s.io/vv1', 'time': '2026-02-10T11:53:39Z', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:roleRef': {}, 'f:subjects': {}}}]}, 'subjects': [{'kind': 'ServiceAccount', 'name': 'vmi-reset-edit-sa'}], 'roleRef': {'apiGroup': 'rbac.authorization.k8s.io', 'kind': 'ClusterRole', 'name': 'edit'}}
2026-02-10T11:53:39.840239 ocp_resources RoleBinding INFO Wait until RoleBinding vmi-reset-edit-sa-edit-binding is deleted
2026-02-10T11:53:39.840447 timeout_sampler INFO Waiting for 240 seconds [0:04:00], retry every 1 seconds. (Function: ocp_resources.resource.wait_deleted.lambda: self.exists)
2026-02-10T11:53:39.847408 timeout_sampler INFO Elapsed time: 9.107589721679688e-05 [0:00:00.000091]
2026-02-10T11:53:39.847618 ocp_resources ServiceAccount INFO Delete ServiceAccount vmi-reset-edit-sa
2026-02-10T11:53:39.856931 ocp_resources ServiceAccount INFO Deleting {'kind': 'ServiceAccount', 'apiVersion': 'v1', 'metadata': {'name': 'vmi-reset-edit-sa', 'namespace': 'node-general-test-vmi-reset-comprehensive', 'uid': 'a09975b7-90c2-4106-8ef-9ccad211dbd8', 'resourceVersion': '6310056', 'creationTimestamp': '2026-02-10T11:53:39Z', 'annotations': {'openshift.io/internal-registry-pull-secret-ref': 'vmi-reset-edit-sa-dockercfg-fncxm'}, 'managedFields': [{'manager': 'openshift.io/image-registry-pull-secrets_service-account-controller', 'operation': 'Apply', 'apiVersion': 'v1', 'time': '2026-02-10T11:53:39Z', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:imagePullSecrets': {}, 'f:metadata': {'f:annotations': {'f:openshift.io/internal-registry-pull-secret-ref': {}}}, 'f:secrets': {'k:{"name":"vmi-reset-edit-sa-dockercfg-fncxm"}': {}}}}]}, 'secrets': [{'name': 'vmi-reset-edit-sa-dockercfg-fncxm'}], 'imagePullSecrets': [{'name': 'vmi-reset-edit-sa-dockercfg-fncxm'}]}
2026-02-10T11:53:39.868208 ocp_resources ServiceAccount INFO Wait until ServiceAccount vmi-reset-edit-sa is deleted
2026-02-10T11:53:39.868411 timeout_sampler INFO Waiting for 240 seconds [0:04:00], retry every 1 seconds. (Function: ocp_resources.resource.wait_deleted.lambda: self.exists)
2026-02-10T11:53:39.874679 timeout_sampler INFO Elapsed time: 8.678436279296875e-05 [0:00:00.000087]
2026-02-10T11:53:39.955735 ocp_resources VirtualMachine INFO Wait for VirtualMachine vm-for-reset-test-1770724366-8908286 status to be None
2026-02-10T11:53:39.955989 timeout_sampler INFO Waiting for 240 seconds [0:04:00], retry every 1 seconds. (Function: kubernetes.dynamic.client.get  Kwargs: {'field_selector': 'metadata.name==vm-for-reset-test-1770724366-8908286', 'namespace': 'node-general-test-vmi-reset-comprehensive'})
2026-02-10T11:53:40.989428 timeout_sampler INFO Elapsed time: 1.013617992401123 [0:00:01.013618]
2026-02-10T11:53:40.989755 ocp_resources.resource INFO kind: VirtualMachineInstance api version: kubevirt.io/v1
2026-02-10T11:53:40.989901 ocp_resources VirtualMachineInstance INFO Wait until VirtualMachineInstance vm-for-reset-test-1770724366-8908286 is deleted
2026-02-10T11:53:40.990059 timeout_sampler INFO Waiting for 480 seconds [0:08:00], retry every 1 seconds. (Function: ocp_resources.resource.wait_deleted.lambda: self.exists)
2026-02-10T11:53:46.038144 timeout_sampler INFO Elapsed time: 5.040846586227417 [0:00:05.040847]
2026-02-10T11:53:46.038398 ocp_resources VirtualMachine INFO Delete VirtualMachine vm-for-reset-test-1770724366-8908286
2026-02-10T11:53:46.055243 ocp_resources VirtualMachine INFO Deleting {'apiVersion': 'kubevirt.io/v1', 'kind': 'VirtualMachine', 'metadata': {'annotations': {'kubemacpool.io/transaction-timestamp': '2026-02-10T11:53:39.928918329Z', 'kubevirt.io/latest-observed-api-version': 'v1', 'kubevirt.io/storage-observed-api-version': 'v1'}, 'creationTimestamp': '2026-02-10T11:52:47Z', 'finalizers': ['kubevirt.io/virtualMachineControllerFinalize'], 'generation': 3, 'labels': {'kubevirt.io/vm': 'vm-for-reset-test'}, 'managedFields': [{'apiVersion': 'kubevirt.io/v1', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:metadata': {'f:labels': {'.': {}, 'f:kubevirt.io/vm': {}}}, 'f:spec': {'.': {}, 'f:template': {'.': {}, 'f:metadata': {'.': {}, 'f:creationTimestamp': {}, 'f:labels': {'.': {}, 'f:debugLogs': {}, 'f:kubevirt.io/domain': {}, 'f:kubevirt.io/vm': {}}}, 'f:spec': {'.': {}, 'f:domain': {'.': {}, 'f:cpu': {'.': {}, 'f:cores': {}}, 'f:devices': {'.': {}, 'f:disks': {}, 'f:interfaces': {}, 'f:rng': {}}, 'f:machine': {'.': {}, 'f:type': {}}, 'f:memory': {'.': {}, 'f:guest': {}}}, 'f:networks': {}, 'f:terminationGracePeriodSeconds': {}, 'f:volumes': {}}}}}, 'manager': 'OpenAPI-Generator', 'operation': 'Update', 'time': '2026-02-10T11:52:46Z'}, {'apiVersion': 'kubevirt.io/v1', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:metadata': {'f:annotations': {'f:kubevirt.io/latest-observed-api-version': {}, 'f:kubevirt.io/storage-observed-api-version': {}}, 'f:finalizers': {'.': {}, 'v:"kubevirt.io/virtualMachineControllerFinalize"': {}}}}, 'manager': 'virt-controller', 'operation': 'Update', 'time': '2026-02-10T11:52:47Z'}, {'apiVersion': 'kubevirt.io/v1', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:spec': {'f:runStrategy': {}}}, 'manager': 'virt-api', 'operation': 'Update', 'time': '2026-02-10T11:53:39Z'}, {'apiVersion': 'kubevirt.io/v1', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:status': {'.': {}, 'f:conditions': {}, 'f:desiredGeneration': {}, 'f:observedGeneration': {}, 'f:printableStatus': {}, 'f:runStrategy': {}, 'f:volumeSnapshotStatuses': {}}}, 'manager': 'virt-controller', 'operation': 'Update', 'subresource': 'status', 'time': '2026-02-10T11:53:45Z'}], 'name': 'vm-for-reset-test-1770724366-8908286', 'namespace': 'node-general-test-vmi-reset-comprehensive', 'resourceVersion': '6310208', 'uid': 'c8596f2c-3ad8-4405-a95c-a75f35ca94f6'}, 'spec': {'runStrategy': 'Halted', 'template': {'metadata': {'creationTimestamp': None, 'labels': {'debugLogs': 'true', 'kubevirt.io/domain': 'vm-for-reset-test-1770724366-8908286', 'kubevirt.io/vm': 'vm-for-reset-test-1770724366-8908286'}}, 'spec': {'architecture': 'amd64', 'domain': {'cpu': {'cores': 1}, 'devices': {'disks': [{'disk': {'bus': 'virtio'}, 'name': 'containerdisk'}, {'disk': {'bus': 'virtio'}, 'name': 'cloudinitdisk'}], 'interfaces': [{'macAddress': '02:22:9f:48:8e:01', 'masquerade': {}, 'name': 'default'}], 'rng': {}}, 'firmware': {'serial': '7beb0178-e3d6-4831-a92e-6e5c0fb71563', 'uuid': '5cd813a2-a0a0-4e91-a0ca-47017966593a'}, 'machine': {'type': 'pc-q35-rhel9.6.0'}, 'memory': {'guest': '1Gi'}, 'resources': {}}, 'networks': [{'name': 'default', 'pod': {}}], 'terminationGracePeriodSeconds': 30, 'volumes': [{'containerDisk': {'image': 'quay.io/openshift-cnv/qe-cnv-tests-fedora:41@sha256:a91659fba4e0258dda1be076dd6e56e34d9bf3dce082e57f939994ce0f124348'}, 'name': 'containerdisk'}, {'cloudInitNoCloud': {'userData': '*******'}, 'name': 'cloudinitdisk'}]}}}, 'status': {'conditions': [{'lastProbeTime': '2026-02-10T11:53:45Z', 'lastTransitionTime': '2026-02-10T11:53:45Z', 'message': 'VMI does not exist', 'reason': 'VMINotExists', 'status': 'False', 'type': 'Ready'}, {'lastProbeTime': None, 'lastTransitionTime': None, 'status': 'True', 'type': 'LiveMigratable'}, {'lastProbeTime': None, 'lastTransitionTime': None, 'status': 'True', 'type': 'StorageLiveMigratable'}], 'desiredGeneration': 3, 'observedGeneration': 3, 'printableStatus': 'Stopped', 'runStrategy': 'Halted', 'volumeSnapshotStatuses': [{'enabled': False, 'name': 'containerdisk', 'reason': 'Snapshot is not supported for this volumeSource type [containerdisk]'}, {'enabled': False, 'name': 'cloudinitdisk', 'reason': 'Snapshot is not supported for this volumeSource type [cloudinitdisk]'}]}}
2026-02-10T11:53:46.144667 ocp_resources VirtualMachine INFO Wait until VirtualMachine vm-for-reset-test-1770724366-8908286 is deleted
2026-02-10T11:53:46.144866 timeout_sampler INFO Waiting for 240 seconds [0:04:00], retry every 1 seconds. (Function: ocp_resources.resource.wait_deleted.lambda: self.exists)
2026-02-10T11:53:47.162329 timeout_sampler INFO Elapsed time: 1.0086634159088135 [0:00:01.008663]
===================================================================================== warnings summary =====================================================================================
tests/virt/node/general/test_vmi_restt_comprehensive.py: 25 warnings
tests/deprecated_api/test_deprecation_audit_logs.py: 4 warnings
.venv/lib/python3.14/site-packages/kubernetes/client/exceptions.py:91: 2 warnings
  /thesis/parallel/3-openshift-virtualization-tests/.venv/lib/python3.14/site-packages/kubernetes/client/exceptions.py:91: DeprecationWarning: HTTPResponse.getheaders() is deprecated and will be removed in urllib3 v2.1.0. Instead access HTTPResponse.headers directly.
    self.headers = http_resp.getheaders()

tests/virt/node/general/test_vmi_reset_comprehensive.py::TestVMIReset::test_reset_running_vmi_via_api
tests/virt/node/general/test_vmi_reset_comprehensive.py::TestVMIReset::test_reset_running_vmi_via_api
  /thesis/parallel/3-openshift-virtualization-tests/.venv/lib/python3.14/site-packages/ocp_resources/resource.py:1612: FutureWarning: 'client' arg will be mandatory in the next major release. `config_file` and `context` args will be removed.
    super().__init__(

tests/virt/node/general/test_vmi_reset_comprehensive.py::TestVMIResetErrorHandling::test_reset_stopped_vmi_fails
  /thesis/parallel/3-openshift-virtualization-tests/.venv/lib/python3.14/site-packages/kubernetes/client/rest.py:44: DeprecationWarning: HTTPResponse.getheaders() is deprecated and will be removed in urllib3 v2.1.0. Instead access HTTPResponse.headers directly.
    return self.urllib3_response.getheaders()

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================================================================= short test summary info ==================================================================================
FAILED tests/virt/node/general/test_vmi_reset_comprehensive.py::TestVMIResetRBAC::test_user_with_edit_role_can_reset_vmi - AttributeError: 'ServiceAccount' object has no attribute 'get_sa_token'
FAILED tests/virt/node/general/test_vmi_reset_comprehensive.py::TestVMIResetRBAC::test_user_without_reset_permission_cannot_reset_vmi - AttributeError: 'ServiceAccount' object has no attribute 'get_sa_token'
ERROR tests/virt/node/general/test_vmi_reset_comprehensive.py::TestVMIResetErrorHandling::test_reset_stopped_vmi_fails - kubernetes.client.exceptions.ApiException: (409)
ERROR tests/virt/node/general/test_vmi_reset_comprehensive.py::TestVMIResetErrorHandling::test_reset_paused_vmi_behavior - kubernetes.client.exceptions.ApiException: (409)
ERROR tests/virt/node/general/test_vmi_reset_comprehensive.py::TestVMIResetErrorHandling::test_reset_nonexistent_vmi_fails - kubernetes.client.exceptions.ApiException: (409)
====================================================== 2 failed, 6 passed, 34 warnings, 3 errors, 1 quarantined in 676.64s (0:11:16) =======================================================
2026-02-10T11:56:55.694638 timeout_sampler INFO Waiting for 240 seconds [0:04:00], retry every 1 seconds. (Function: ocp_resources.resource.wait_deleted.lambda: self.exists)
2026-02-10T11:56:55.702137 timeout_sampler INFO Elapsed time: 0.0001811981201171875 [0:00:00.000181]
2026-02-10T11:56:55.736523 timeout_sampler INFO Waiting for 240 seconds [0:04:00], retry every 1 seconds. (Function: ocp_resources.resource.wait_deleted.lambda: self.exists)
2026-02-10T11:57:04.814066 timeout_sampler INFO Elapsed time: 9.069126844406128 [0:00:09.069127]
